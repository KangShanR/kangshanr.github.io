<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <title>Kang Shan</title>
    
<link rel="stylesheet" href="/css/style.css">

    
<link rel="stylesheet" href="/css/gitment.css">

    <link rel="stylesheet" type="text/css" href="//at.alicdn.com/t/font_859455_eaq7v6w8ktj.css">
<meta name="generator" content="Hexo 5.4.0"></head>
<body>
<header class="header">
    <div class="header-inner">
        <div class="header-title">

        </div>
        <nav class="header-nav">
            
            <a href="/" class="header-nav-link" >
                Home
            </a>
            

            
            <a href="/archives" class="header-nav-link">
                Archives
            </a>
            

            
            <a href="/tags" class="header-nav-link">
                Tags
            </a>
            

            
        </nav>
    </div>
</header>
<header class="mobile-header">
    <div class="mobile-nav">
        <div class="mobile-nav-icon">
            <span></span>
            <span></span>
            <span></span>
        </div>
        <div class="mobile-nav-title">
            <a href="/" class="mobile-nav-title-link">Kang Shan's Blog</a>
        </div>

    </div>
    <nav class="mobile-menu">
        <ul class="mobile-menu-list">
            <li class="mobile-menu-item">
                <i class="iconfont icon-home"></i>
                <a href="/" class="mobile-nav-link">Home</a>
            </li>
            <li class="mobile-menu-item">
                <i class="iconfont icon-archive"></i>
                <a href="/archives" class="mobile-nav-link">Archives</a>
            </li>
            <li class="mobile-menu-item">
                <i class="iconfont icon-tag"></i>
                <a href="/tags" class="mobile-nav-link">Tags</a>
            </li>
            <li class="mobile-menu-item">
                <i class="iconfont icon-about"></i>
                <a href="/about/" class="mobile-nav-link">About</a>
            </li>
        </ul>
    </nav>
</header>
<div class="main">
    <div class="content-inner">
        <div class="posts">
    <article class="post-whole">
        <div class="post-title">
            <h2 class="title"></h2>
            <div class="post-meta">
                <span class="post-time">2017-08-15</span>
                
                <span class="post-category">
                    
                    <a class="category" href="/categories/programming/">programming</a>
                    
                </span>
                
                <span class="post-visit"> visited：<span id="busuanzi_value_page_pv"></span></span>
            </div>
        </div>
        <div class="post-toc" id="post-toc">
    <strong class="post-toc-title">目录</strong>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-spring"><span class="toc-text">1. spring</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-ioc"><span class="toc-text">1.1. ioc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-1-BeanFactory"><span class="toc-text">1.1.1. BeanFactory</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-2-ApplicationContext"><span class="toc-text">1.1.2. ApplicationContext</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-Core-%E6%A8%A1%E5%9D%97"><span class="toc-text">1.2. Core 模块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-AOP-%E6%A8%A1%E5%9D%97"><span class="toc-text">1.3. AOP 模块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-ORM-%E6%A8%A1%E5%9D%97"><span class="toc-text">1.4. ORM 模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-1-%E5%AE%9E%E4%BD%93%E7%B1%BB"><span class="toc-text">1.4.1. 实体类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-1-1-%E9%85%8D%E7%BD%AE%E9%9B%86%E6%88%90Hibernate"><span class="toc-text">1.4.1.1. 配置集成Hibernate</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-2-Hibernate%E7%9A%84%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="toc-text">1.4.2. Hibernate的事务管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-3-spring%E7%9A%84bean-xml%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E7%90%86%E8%A7%A3"><span class="toc-text">1.4.3. spring的bean.xml配置文件的理解</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-5-source-codes"><span class="toc-text">1.5. source codes</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rap-%E5%9C%A8%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">rap 在项目开发中的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%97%AE%E9%A2%98"><span class="toc-text">问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#properties-in-springmvc"><span class="toc-text">properties in springmvc</span></a></li></ol></li></ol>
    <div class="back-to-top" id="back-to-top">
        <a href="javascript:void(0);">回到顶部</a>
    </div>
</div>
        <div class="post-content">
            <!-- TOC -->

<ul>
<li><a href="#1-spring">1. spring</a><ul>
<li><a href="#11-ioc">1.1. ioc</a><ul>
<li><a href="#111-beanfactory">1.1.1. BeanFactory</a></li>
<li><a href="#112-applicationcontext">1.1.2. ApplicationContext</a></li>
</ul>
</li>
<li><a href="#12-core-%E6%A8%A1%E5%9D%97">1.2. Core 模块</a></li>
<li><a href="#13-aop-%E6%A8%A1%E5%9D%97">1.3. AOP 模块</a></li>
<li><a href="#14-orm-%E6%A8%A1%E5%9D%97">1.4. ORM 模块</a><ul>
<li><a href="#141-%E5%AE%9E%E4%BD%93%E7%B1%BB">1.4.1. 实体类</a><ul>
<li><a href="#1411-%E9%85%8D%E7%BD%AE%E9%9B%86%E6%88%90hibernate">1.4.1.1. 配置集成Hibernate</a></li>
</ul>
</li>
<li><a href="#142-hibernate%E7%9A%84%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86">1.4.2. Hibernate的事务管理</a></li>
<li><a href="#143-spring%E7%9A%84beanxml%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E7%90%86%E8%A7%A3">1.4.3. spring的bean.xml配置文件的理解</a></li>
</ul>
</li>
<li><a href="#15-source-codes">1.5. source codes</a></li>
<li><a href="#rap-%E5%9C%A8%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8">rap 在项目开发中的使用</a><ul>
<li><a href="#%E9%97%AE%E9%A2%98">问题</a></li>
</ul>
</li>
<li><a href="#properties-in-springmvc">properties in springmvc</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->

<h1 id="1-spring"><a href="#1-spring" class="headerlink" title="1. spring"></a>1. spring</h1><blockquote>
<p>spring 配置 beans 的底层原理就在于通过封装好的解析 xml 类，将 xml 文件中配置好的 bean 实例出一个对象来，再通过配置实现 bean 之间的相互引用，而实现将要用到的 bean （实用类）实例化并使用；</p>
</blockquote>
<ul>
<li>通过 DI(dependency injection) 依赖注入，实现 IoC(Inverse of Control) 反转控制，将所有的 bean 注入 IoC 容器。</li>
<li>ioc 等于 di</li>
<li>IoC 的实现：将容器在装配 bean 时，先通过其构造器或工厂生产一个实例后，再根据其配置去构造 bean 的各个依赖。这与传统的实例生成方法相反，所以叫反转控制。</li>
<li><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#application-startup-steps">启动步骤</a></li>
</ul>
<h2 id="1-1-ioc"><a href="#1-1-ioc" class="headerlink" title="1.1. ioc"></a>1.1. ioc</h2><h3 id="1-1-1-BeanFactory"><a href="#1-1-1-BeanFactory" class="headerlink" title="1.1.1. BeanFactory"></a>1.1.1. BeanFactory</h3><p>最基础的 ioc 容器 BeanFactory 源码：</p>
<p>Bean factory implementations should support the standard bean lifecycle interfaces as far as possible. The full set of initialization methods and their standard order is:</p>
<ol>
<li>BeanNameAware’s {@code setBeanName}</li>
<li>BeanClassLoaderAware’s {@code setBeanClassLoader}</li>
<li>BeanFactoryAware’s {@code setBeanFactory}</li>
<li>EnvironmentAware’s {@code setEnvironment}</li>
<li>EmbeddedValueResolverAware’s {@code setEmbeddedValueResolver}</li>
<li>ResourceLoaderAware’s {@code setResourceLoader}(only applicable when running in an application context)</li>
<li>ApplicationEventPublisherAware’s {@code setApplicationEventPublisher}(only applicable when running in an application context)</li>
<li>MessageSourceAware’s {@code setMessageSource}(only applicable when running in an application context)</li>
<li>ApplicationContextAware’s {@code setApplicationContext}(only applicable when running in an application context)</li>
<li>ServletContextAware’s {@code setServletContext}(only applicable when running in a web application context)</li>
<li>{@code postProcessBeforeInitialization} methods of BeanPostProcessors</li>
<li>InitializingBean’s {@code afterPropertiesSet}</li>
<li>a custom init-method definition {@code postProcessAfterInitialization} methods of BeanPostProcessors</li>
</ol>
<p>On shutdown of a bean factory, the following lifecycle methods apply:</p>
<ol>
<li>{@code postProcessBeforeDestruction} methods of DestructionAwareBeanPostProcessors</li>
<li>DisposableBean’s {@code destroy}</li>
<li>a custom destroy-method definition</li>
</ol>
<h3 id="1-1-2-ApplicationContext"><a href="#1-1-2-ApplicationContext" class="headerlink" title="1.1.2. ApplicationContext"></a>1.1.2. ApplicationContext</h3><h2 id="1-2-Core-模块"><a href="#1-2-Core-模块" class="headerlink" title="1.2. Core 模块"></a>1.2. Core 模块</h2><ul>
<li>bean 标签：<ul>
<li>id 属性指定这个实例的唯一标识；</li>
<li>class 属性，用来指定这个实例的类定义；</li>
<li>property 子元素，指定这个对象的属性，比如：user 对象中有属性 name ，那么这个这个 user 的 bean 对象就应该有一个子元素标签 property ，同时如果这个属性是另外一个本地的 bean ， name 属性指向这个属性：<code>&lt;property name=&quot;advice&quot; id=&quot;beanId&quot;&gt;</code> 直接使用 id 属性来引用到其他的 bean 的 id 就行；</li>
</ul>
</li>
</ul>
<h2 id="1-3-AOP-模块"><a href="#1-3-AOP-模块" class="headerlink" title="1.3. AOP 模块"></a>1.3. AOP 模块</h2><blockquote>
<p>Aspect Oriented Programming , 面向切面编程</p>
</blockquote>
<ul>
<li><p>切面 Aspect :可以理解为模块，比如，读写数据库、权限检查、异常情况记录；</p>
</li>
<li><p>Advice ，增强：拦截器实现增强接口 Advisor ，不同的拦截器实现不同的增强接口，比如：方法前拦截器</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">MethodBeforeInterceptor implements MethodBeforeAdvice&#123;</span><br><span class="line">    <span class="comment">//方法前拦截器</span></span><br><span class="line">    <span class="comment">//调用对象的方法前将执行该方法。参数分别为被调用的方法、参数、对象</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">(Method method, Object[] args, Object instance)</span> <span class="keyword">throws</span> Throwable</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;即将要执行的方法：&quot;</span> + method.getName());</span><br><span class="line">        <span class="comment">//如果是 Service</span></span><br><span class="line">        <span class="keyword">if</span>(instance <span class="keyword">instanceof</span> WaiterServiceImpl)</span><br><span class="line">            String name = ((AopServiceImpl) instance).getName();</span><br><span class="line">                <span class="keyword">if</span>(name == <span class="keyword">null</span>)<span class="comment">//检查是否为空</span></span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException(<span class="string">&quot;name 属性不能为 null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        method.invoke(instance,args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>拦截器，interceptor，也是 pointcut 的核心:</p>
<ul>
<li><p>spring拦截器的配置实现，通过增加配置：</p>
  <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;aopMethodBeforeInterceptor&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.aop.supoort.NameMatchMethodPointcutAdvisor&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;advice&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.snail.aopdemo.advice.MethodBeforeInterceptor&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;mappedName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;withAop&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>从上面的代码可以看出：</p>
<ul>
<li><p>spring实现拦截器都是通过增强器Advisor，而这个增强器是一个代理，将参数（自定义的Advice）作为参数传入其中；</p>
</li>
<li><p>同时mappedName属性用来指定拦截的方法，这个方法并不是增加类中的方法，而是到时要执行到的所有的匹配方法名字段的方法；</p>
</li>
<li><p>同时：spring支持由正则表达式配置切入点：</p>
  <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;patterns&quot;</span>&gt;</span>      <span class="comment">&lt;!-- 正则表达式配置切入点--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>.*get.*<span class="tag">&lt;/<span class="name">value</span>&gt;</span> <span class="comment">&lt;!--包含get字段的方法就被拦截&gt;</span></span><br><span class="line"><span class="comment">        &lt;value&gt;.*absquatulate&lt;/value&gt;  &lt;!--包含absquatutulat字段的方法被拦截&gt;</span></span><br><span class="line"><span class="comment">    &lt;/list&gt;</span></span><br><span class="line"><span class="comment">&lt;/property&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="1-4-ORM-模块"><a href="#1-4-ORM-模块" class="headerlink" title="1.4. ORM 模块"></a>1.4. ORM 模块</h2><blockquote>
<p>Object RelativeDatabase Mapping,对象关系型数据库映射</p>
</blockquote>
<ul>
<li>简介：<ul>
<li>此模块对 Hibernate/JDO/TopLink、iBatis 等 ORM 框架提供支持；</li>
<li>Spring 提供在 DAO 层提供 HibernateDaoSupport 类与 JDBCTemplate 类；</li>
<li>在 Spring 里，Hibernate 与 SessionFactory 等只是 Spring 一个特殊的 Bean ，由 spring 负责实例化与销毁；所以也就不需要与 Hibernate 的 API 打交道，不需要开启关闭 Hibernate 的 Session/Transaction ， Spring 自动维护这些对象；</li>
</ul>
</li>
</ul>
<h3 id="1-4-1-实体类"><a href="#1-4-1-实体类" class="headerlink" title="1.4.1. 实体类"></a>1.4.1. 实体类</h3><p>这儿用User类举例：</p>
<ul>
<li><p>使用注解来让User中属性与数据库中表的列相关联；</p>
</li>
<li><p>Entity类的注解：</p>
<ul>
<li>@Entity，表明这个类为实体类；</li>
<li>@Table（name=”users”),指明此实体类与数据库users表相关联；</li>
<li>属性的注解：<ul>
<li>@Id，主键注解，表明这属性为数据库表中的主键</li>
<li>@GeneratedValue（strategy=GenerationType.IDENTITY),指明该主键生成策略为自增</li>
<li>@Temporal（value = TemporalType.Date),表明列属性为Date</li>
</ul>
</li>
</ul>
</li>
<li><p>DAO层接口，不同的Entity对应不同的DAO接口：</p>
<ul>
<li><p>UserDao接口，就定义对User表的操作：</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveUser</span><span class="params">(User user)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">findUsers</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span> <span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">findUserByName</span><span class="params">(String name)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>UserDao接口的实现类，UserDaoImpl：</p>
<ul>
<li>这个实现类要继承HibernateDaoSupport类，这就意味着从父类继承了Hibernate与HibernateTimplate对象，该对象就对实体对象进行各类操作；</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImpl</span> <span class="keyword">extends</span> <span class="title">HibernateDaoSupport</span> <span class="keyword">implements</span> <span class="title">UserDao</span></span>&#123;</span><br><span class="line">    <span class="comment">//实现接口中的方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveUser</span><span class="params">(User user)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.getHibernateTemplate().persist(user);<span class="comment">//使用父类方法get到Template,并调用其persist方法将user存入</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span></span>&#123;   <span class="comment">//查询记录条数</span></span><br><span class="line">        Number num = (Number)<span class="keyword">this</span>.getSession(<span class="keyword">true</span>).createQuery(<span class="string">&quot;select count (*) from User).uniqueResult();</span></span><br><span class="line"><span class="string">        return n.intValue();</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    public List&lt;User&gt; findUsers()&#123;  //查询所有的user</span></span><br><span class="line"><span class="string">        return this.getHibernateTemplate().find(&quot;</span>select * from User<span class="string">&quot;);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    public User findUserByName(String name)&#123;  //根据用户名查询用户</span></span><br><span class="line"><span class="string">        List&lt;User&gt; users = this.getHibernateTemplate().find&#123;&quot;</span>select * from User u where u.name=?<span class="string">&quot;, name);  //使用Template</span></span><br><span class="line"><span class="string">        if(users.size() &gt; 0)</span></span><br><span class="line"><span class="string">            return users.get(0);返回第一条</span></span><br><span class="line"><span class="string">        return null;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<pre><code>- **从上述代码例子中可以看出:**
    - 查询(Read)、创建(Create)都由父类HibernateDaoSupport提供的getHibernateTemplate方法获取到实例并执行实例的方法来实现，其中查询使用实例方法find(String sql, Stirng 拼接String），而save则用持久化方法persist(Object user);
    - 当要涉及到数据库计算时，则用getSession获取到与数据库的会话对象，让会话对象执行sql统计语句；
    - 同时，所有sql语言的操作对象都指向实体类，而没有对数据库中的表进行组织sql语句；
- **个人理解：**spring通过封装Hibernate在框架中，让DAO接口的实现类继承HibernateDaoSupport尖，就将Hibernate对象创建出来，而直接操作这个对象的方法来获取session/Hibernate对象直接与数据库交互，而就节省了操作JDBC的代码；
</code></pre>
<h4 id="1-4-1-1-配置集成Hibernate"><a href="#1-4-1-1-配置集成Hibernate" class="headerlink" title="1.4.1.1. 配置集成Hibernate"></a>1.4.1.1. 配置集成Hibernate</h4><ul>
<li>在spring的bean.xml文件中配置集成hibernate到目前这一步只需要**<em>配置三个bean**</em>：<ul>
<li>数据源datasource，这是一切的基础，所有的操作最终都会落到对数据库的操作上；</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;datasource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.apache.commonsdbcp.BasicDataSource&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.gjt.mm.mysql.Driver&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc\:mysql\://localhost\:3306/ssh&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">propery</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><em>- 数据源的配置就是用依赖包中的一个封装好的类（这儿就是BasicDataSource）的对象，并将这个对象的属性值配置好，这些属性就包括了数据库的驱动、连接的url、连接数据库的用户名、密码。可以想象的是，这个处理数据库的对象封装了所有的连接数据库的方法，使用密码与用户名，交给驱动对象，这个驱动对象就按照提供的url连接到主机上的数据库，并登录到数据库；</em><br>    - 有了数据源，就可以将关联连接库的数据源配置到sessionFactory中去：</p>
<pre><code>    <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.hibernate4.annotation.AnnotationSessionFactoryBean&quot;</span> <span class="attr">destroy-method</span>=<span class="string">&quot;destroy&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;annotatedClasses&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.woniuxy.orm.class_qulified_name<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernateProperties&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">pros</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pro</span> <span class="attr">key</span>=<span class="string">&quot;hibernate.dialect&quot;</span>&gt;</span></span><br><span class="line">                org.hibernate.dialect.MySQLDialect</span><br><span class="line">            <span class="tag">&lt;/<span class="name">pro</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pro</span> <span class="attr">key</span>=<span class="string">&quot;hibernate.show_sql&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">pro</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pro</span> <span class="attr">key</span>=<span class="string">&quot;hibernate.format_sql&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">pro</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pro</span> <span class="attr">key</span>=<span class="string">&quot;hibernate.hbm2ddl.auto&quot;</span>&gt;</span>create<span class="tag">&lt;/<span class="name">pro</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">pros</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

    - *配置会话工厂（因为我们的实体类使用的注解映射，所以就使用注解会话工厂AnnotationSessionFatoryBean)其中包括了：数据源、实体类还有hibernate,而hibernate的配置就包括了方言、输出sql语句、格式化sql语句、创建表结构*
- 有了会话工厂，距离操作数据库就只有让Dao配置为bean，而操作代码就getBean来获取到这个Dao的实例，让这个实例来操作数据库：
        &lt;bean id=&quot;userDao&quot; class=&quot;daoImpl_qualified_name&quot;&gt;
            &lt;property name=&quot;sessionfactory&quot; ref=&quot;sessionFactory&quot; /&gt;
        &lt;/bean&gt;
    - *在Dao的bean中，将前面配置好的sessionFactory装配到其中*
- 以上情况是实体类User是使用注解来配置的，这种情况下，使用的sessionFactory是AnnotationSessionFactoryBean,但当实体类是使用xml文件来配置时，使用的配置bean应该是LocalSessionFactoryBean。同时，sessionFactory中配置实体的方式也变成：
        &lt;property name=&quot;mappingDirectoryLocations&quot;&gt;
            &lt;list&gt;
                &lt;value&gt;classpath:entiteis_配置文件的路径&lt;/value&gt;
            &lt;/list&gt;
        &lt;/property&gt;
</code></pre>
<hr>
<h3 id="1-4-2-Hibernate的事务管理"><a href="#1-4-2-Hibernate的事务管理" class="headerlink" title="1.4.2. Hibernate的事务管理"></a>1.4.2. Hibernate的事务管理</h3><ul>
<li><strong>分层的做法：应用层调用Service层，Service层对数据进行检查（是否重复之类），然后Service层（注入一个Dao属性）调用Dao层，Dao层调用Hibernate实现数据的操作。原则上不允许跨层访问，业务层次分明。</strong></li>
<li>事务管理transaction，对应的层为Service层；</li>
</ul>
<h3 id="1-4-3-spring的bean-xml配置文件的理解"><a href="#1-4-3-spring的bean-xml配置文件的理解" class="headerlink" title="1.4.3. spring的bean.xml配置文件的理解"></a>1.4.3. spring的bean.xml配置文件的理解</h3><ul>
<li>所有的操作都基于对数据库的crud，所以所有的配置都围绕着操作数据库；</li>
<li>所以，第一个bean的是数据源：dataSource<ul>
<li>其中的属性就包括：<ul>
<li>连接数据库的驱动：driverClassName</li>
<li>数据库连接url:url</li>
<li>数据库连接用户名：username</li>
<li>数据库连接密码：password</li>
</ul>
</li>
<li>通常情况下，我们把数据源信息都单独分离在jdbc.properties文件中，并在要用到的配置文件中将其配置为上下文<code>&lt;context:property-placeholder&gt; location=&quot;classpath:jdbc.properties/&gt;</code>，之后就可以在数据源dataSource中配置其中的属性：<code>&lt;property name=&quot;driverClass&quot; value=&quot;$&#123;driver&#125;&quot;&gt;&lt;/property&gt;</code></li>
</ul>
</li>
<li>第二个配置的bean：sessionFactory<ul>
<li>这儿就把上一次配置好的dataSource数据源装配到sessionFactory的属性中：</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置本地会话工厂bean --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.hibernate5.LocalSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置数据源 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 指定hibernate配置文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configLocations&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:hibernate.cfg.xml&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 指定hibernate映射文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;mappingDirectoryLocations&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>classpath:mappings/*.xml<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Note:<em>这儿配置spring的sessionFactory属性就会把 Hibernate sessionFactory属性覆盖；</em></li>
<li>configLocations属性：<em>将指定路径的配置文件都加载进去，相应的LocalSessionFactoryBean中的的此属性的setter方法的参数为可变参数:</em></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setConfigLocations</span><span class="params">(Resource... configLocations)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.configLocations = configLocations;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>而在上述代码中，hibernate的配置文件也直接引入到sessionFatory中来，而在外部的hibernate配置文件：</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">hibernate-configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">session-factory</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 配置方言 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.dialect&quot;</span>&gt;</span>org.hibernate.dialect.MySQL5InnoDBDialect<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- session上下文控制权:交给session来控制 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.current_session_context_class&quot;</span>&gt;</span>org.springframework.orm.hibernate5.SpringSessionContext<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 格式化sql语句 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;format_sql&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 显示sql语句 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;show_sql&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 表的生成策略 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hbm2ddl.auto&quot;</span>&gt;</span>update<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">session-factory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>其中配置了部分的Hibernate属性，同时也可以配置c3p0的属性在其中；</li>
<li>第三个配置：事务管理器transactionManager<ul>
<li>将前面配置好的sessionFactory装配到这个bean中，作为sessionFactory属性值；</li>
</ul>
</li>
<li>第四个配置：tx:advice，配置事务的传播特性，指定具备事务的方法名；</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 事务配置增强 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">&quot;txAdvice&quot;</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;txMng&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;save*&quot;</span> <span class="attr">isolation</span>=<span class="string">&quot;DEFAULT&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;update*&quot;</span> <span class="attr">isolation</span>=<span class="string">&quot;DEFAULT&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;delete*&quot;</span> <span class="attr">isolation</span>=<span class="string">&quot;DEFAULT&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;batch*&quot;</span> <span class="attr">isolation</span>=<span class="string">&quot;DEFAULT&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;get*&quot;</span> <span class="attr">isolation</span>=<span class="string">&quot;DEFAULT&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;load*&quot;</span> <span class="attr">isolation</span>=<span class="string">&quot;DEFAULT&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;find*&quot;</span> <span class="attr">isolation</span>=<span class="string">&quot;DEFAULT&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 统配 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;*&quot;</span> <span class="attr">isolation</span>=<span class="string">&quot;DEFAULT&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br></pre></td></tr></table></figure>

<pre><code>- 最后一行统配就指定了所有的方法都配置上事务，同时 isolation 指此事务的隔离级别，propagation 指事务的传播属性，read-only 指是否为只读；
</code></pre>
<ul>
<li>第五个配置aop:config，配置事务的切入点，以及被管理的对象</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;interceptorPointCuts&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* com.woniuxy.sshdemo.service.impl.*(..))&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;txAdvice&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;interceptorPointCuts&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<pre><code>- 先将切面的切点配置进来，也就是各个service的执行对象。再将这此切点配置到advisor中
</code></pre>
<ul>
<li>其它的配置：<ul>
<li>dao的执行类，配置一个id加上sessionFactory;</li>
<li>service的执行类,配置上dao这个属性的对象；</li>
</ul>
</li>
<li><strong>使用注解来实现事务的配置</strong><ul>
<li>这时bean.xml：<ul>
<li>数据源不变</li>
<li>sessionFactory不变；</li>
<li>事务管理器trasactionManager依然不变；</li>
<li>变的是：添加一个事务注解驱动<code>tx:annotation-driven trasaction-manager=&quot;transactionManager&quot;/&gt;</code>，添加这个驱动配置后，对产生事务的类添加注解<code>@Transactional</code>，标记这个类为事务类，对其中的事务方法添加注解<code>@Transactional(isolation=Isolation.DEFAULT,propagation=Propagation.REQUIRED)</code>注解（标明了这个方法的隔离水平与传播水平）。这样的注解就取代了上面例子中tx:advice与aop:config两个配置节点的功能；</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="1-5-source-codes"><a href="#1-5-source-codes" class="headerlink" title="1.5. source codes"></a>1.5. source codes</h2><p>源码</p>
<ul>
<li><code>@Configuration</code> 用以配置 spring 组件的注解，其文档有详细说明大部分的注解使用。</li>
<li>使用 <code>@ContextConfiguration(locations=&#123;classpath*:xxx&#125;)</code> 时， <code>classpath*:</code> 表示可以从 jar 包里拿配置文件</li>
</ul>
<h2 id="rap-在项目开发中的使用"><a href="#rap-在项目开发中的使用" class="headerlink" title="rap 在项目开发中的使用"></a>rap 在项目开发中的使用</h2><blockquote>
<p>date: “2017-12-05 19:08”</p>
</blockquote>
<p>使用 rap 来定义接口数据，这样方便前端开发人员与我们后端开发在各个接口请求上一致，更方便开发。</p>
<h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><ul>
<li>mock 的使用中： <code>@mock=true</code> 在各个参数后面表示默认的数据格式样式吗？<ul>
<li>时间类型/枚举类型等其他的数据选择什么类型？string？</li>
</ul>
</li>
</ul>
<h2 id="properties-in-springmvc"><a href="#properties-in-springmvc" class="headerlink" title="properties in springmvc"></a>properties in springmvc</h2><blockquote>
<p>date: “2018-12-03 15:05” <a target="_blank" rel="noopener" href="https://www.baeldung.com/properties-with-spring">参考文档</a></p>
</blockquote>
<ul>
<li>在 xml 文件中引入 properties ： <code>&lt;context:property-placeholder location=&quot;classpath:foo.properties&quot; /&gt;</code></li>
<li>在配置 bean java 文件中可以使用注解将其配置：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@PropertySource(&quot;classpath:foo.properties&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PropertiesWithJavaConfig</span></span>&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<pre><code>- 另外一个更有用的注解方法：
</code></pre>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PropertySource(&#123;</span></span><br><span class="line"><span class="meta">  &quot;classpath:persistence-$&#123;envTarget:mysql&#125;.properties&quot;&#125;)</span></span><br></pre></td></tr></table></figure>

<p>  <strong>note</strong>:<br>    - <a target="_blank" rel="noopener" href="http://www.cnblogs.com/jycboy/p/7349139.html">参考</a><br>    - classpath 是指被编译过后的 src 中所有的文件（包括：java、xml、properties）都放在的 WEB-INFO/classes 的文件夹。<br>    - <code>**/</code> 表示 任意目录。<code>**/mysql*.properties</code> 就表示任意目录下的以 <code>mysql</code> 开关的 properties 文件</p>
<ul>
<li><p>在 java 配置文件中插入一个 property 值使用标签 <code>@Value</code> ： <code>@Value(&quot;$&#123;jdbc.url:defaultUrl&#125;&quot;)</code> ， <code>:</code> 后面跟的是默认值。</p>
</li>
<li><p>在 xml 配置文件中插入一个 property 值</p>
<pre><code class="xml">&lt;bean id=&quot;dataSource&quot;&gt;
  &lt;property name=&quot;url&quot; value=&quot;$&#123;jdbc.url&#125;&quot; /&gt;
&lt;/bean&gt;
</code></pre>
</li>
</ul>

        </div>
        
        <div class="post-tag">
            
            <a class="tag" href="/tags/java/" title="java">java</a>
            
            <a class="tag" href="/tags/framework/" title="framework">framework</a>
            
            <a class="tag" href="/tags/spring/" title="spring">spring</a>
            
        </div>
        
    </article>
</div>
<div class="paginator">
    
        
            <a class="prev" href="/2017/08/23/spring/Spring_Bean/">
                <i class="iconfont icon-prev"></i>
                <span class="nav-default">spring bean的理解</span>
                <span class="nav-mobile">Prev</span>
            </a>
        
        
            <a class="next" href="/2017/04/13/java/Hash/">
                <span class="nav-default"></span>
                <span class="nav-mobile">Next</span>
                <i class="iconfont icon-next"></i>
            </a>
        
    
</div>
<div id="comment-container"></div>
    </div>
</div>
<footer class="footer-social">
    
    <a class="social-link" target="_blank" href="https://github.com/KangShanR">
        <i class="iconfont icon-github"></i>
    </a>
    

    

    
    <a class="social-link" target="_blank" href="http://weibo.com/hey_you_go">
        <i class="iconfont icon-weibo"></i>
    </a>
    

    <div class="footer-copyright">
        <p class="time-line">
            &copy;
            
            
                2017 -
            
            2021
            &nbsp;<i class="iconfont icon-heart"></i>&nbsp;
            <a target="_blank" href="https://github.com/iJinxin">Kang Shan</a>
        </p>
        <p class="theme-info">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a>  |  Theme -
            <a target="_blank" href="https://github.com/iJinxin/hexo-theme-sky">Sky</a>
        </p>
    </div>
</footer>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script src="/js/index.js"></script>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
    
    var gitment = new Gitment({
        id: '',
        owner: 'KangShanR',
        repo: '',
        oauth: {
            client_id: '074819c3098d17273370',
            client_secret: '7b600971b388f1af62c5802851a6b8a9130634cd'
        }
    });
    gitment.render('comment-container');
    

</script>
</html>
