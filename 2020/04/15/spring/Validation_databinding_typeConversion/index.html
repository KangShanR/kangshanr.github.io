<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="google-site-verification" content="TZE0rZyIqLl10trYu3BWBWa1Vmz6HFwhb2OcNEK4u-s" />
     <link rel="shortcut icon" href= /img/favicon.ico >
    <title>
        Kang Shan
    </title>
    
<link rel="stylesheet" href="/libs/highlight/styles/monokai-sublime.css">

    
<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>
<body id="bodyx">
    <div class="hd posts">
    <a href="/index.html"><i class="fa fa-home
 replay-btn" aria-hidden="true"></i></a>
    <div class="post-title">
        <p>
            Spring Validating, Data Binding and Type Conversion
        </p>
        <hr>
    </div>
    <div class="post-content">
        <h1 id="1-Validating-amp-Data-Binding-and-Type-Conversion"><a href="#1-Validating-amp-Data-Binding-and-Type-Conversion" class="headerlink" title="1. Validating &amp; Data Binding and Type Conversion"></a>1. Validating &amp; Data Binding and Type Conversion</h1><!-- TOC -->

<ul>
<li><a href="#1-validating--data-binding-and-type-conversion">1. Validating &amp; Data Binding and Type Conversion</a><ul>
<li><a href="#11-validation-on-springs-validator-interface">1.1. Validation on Spring’s Validator Interface</a><ul>
<li><a href="#111-configuring-a-bean-validation-provider">1.1.1. Configuring a Bean Validation Provider</a></li>
<li><a href="#112-resolving-codes-to-error-messages">1.1.2. Resolving Codes to Error Messages</a></li>
</ul>
</li>
<li><a href="#12-bean-manipulation-and-the-beanwrapper">1.2. Bean Manipulation and the <code>BeanWrapper</code></a><ul>
<li><a href="#121-built-in-propertyeditor-implements">1.2.1. Built-in <code>PropertyEditor</code> Implements</a><ul>
<li><a href="#1211-spring-%E5%86%85%E7%BD%AE%E7%9A%84-propertyeditor-%E5%AE%9E%E7%8E%B0">1.2.1.1. Spring 内置的 <code>PropertyEditor</code> 实现</a></li>
<li><a href="#1212-%E6%B3%A8%E5%86%8C%E8%87%AA%E5%AE%9A%E4%B9%89-propertyeditor">1.2.1.2. 注册自定义 <code>PropertyEditor</code></a><ul>
<li><a href="#12121-%E4%BD%BF%E7%94%A8-propertyeditorregistrar">1.2.1.2.1. 使用 <code>PropertyEditorRegistrar</code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#13-spring-type-conversion">1.3. Spring Type Conversion</a><ul>
<li><a href="#131-converter-spi">1.3.1. Converter SPI</a></li>
<li><a href="#132-converterfactory">1.3.2. ConverterFactory</a></li>
<li><a href="#133-genericconverter">1.3.3. GenericConverter</a></li>
<li><a href="#134-conditionalgenericconverter">1.3.4. ConditionalGenericConverter</a></li>
<li><a href="#135-formatting">1.3.5. Formatting</a></li>
<li><a href="#136-the-conversionservice-api">1.3.6. The <code>ConversionService</code> API</a></li>
<li><a href="#137-%E9%85%8D%E7%BD%AE-conversionservice">1.3.7. 配置 <code>ConversionService</code></a></li>
</ul>
</li>
<li><a href="#14-spring-field-formatting">1.4. Spring Field Formatting</a><ul>
<li><a href="#141-%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8-formatting">1.4.1. 注解驱动 Formatting</a></li>
<li><a href="#142-%E6%8B%93%E5%B1%95-formatting-%E6%B3%A8%E5%86%8C">1.4.2. 拓展 Formatting 注册</a></li>
</ul>
</li>
<li><a href="#15-spring-mvc-%E4%B8%AD%E9%85%8D%E7%BD%AE%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%9A%84-converter">1.5. Spring MVC 中配置序列化与反序列化的 Converter</a><ul>
<li><a href="#151-%E5%BA%8F%E5%88%97%E5%8C%96%E6%97%B6%E9%97%B4%E7%B1%BB%E5%9E%8B%E6%95%B0%E6%8D%AE">1.5.1. 序列化时间类型数据</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- /TOC -->

<p><a target="_blank" rel="noopener" href="https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#validation">spring reference</a></p>
<p>Spring 中的 数据验证、数据绑定、类型转换。</p>
<h2 id="1-1-Validation-on-Spring’s-Validator-Interface"><a href="#1-1-Validation-on-Spring’s-Validator-Interface" class="headerlink" title="1.1. Validation on Spring’s Validator Interface"></a>1.1. Validation on Spring’s Validator Interface</h2><ul>
<li>实现接口 Validator ，定义验证各个 POJO 的代码。</li>
<li>结合 `ValidationUtils 使用</li>
</ul>
<h3 id="1-1-1-Configuring-a-Bean-Validation-Provider"><a href="#1-1-1-Configuring-a-Bean-Validation-Provider" class="headerlink" title="1.1.1. Configuring a Bean Validation Provider"></a>1.1.1. Configuring a Bean Validation Provider</h3><p><a target="_blank" rel="noopener" href="https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#validation-beanvalidation-overview">reference</a></p>
<ul>
<li><p><code>LocalValidatorFactoryBean</code> 继承了 ValidatorFactory 和 Validator 两个接口，将其注册为一个 Bean。</p>
</li>
<li><p>在需要使用验证的 Bean 中注入 Validator 即可。</p>
</li>
<li><p>使用 <code>@Constraint</code> 自定义约束，再使用 <code>ConstraintValidator</code> 实现约束行为。</p>
</li>
<li><p>Spring 驱动方法验证</p>
<ul>
<li><p>整合方法验证直接将 <code>MethodValidationPostProcessor</code> 注册到容器中</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> MethodValidationPostProcessor <span class="title">validationPostProcessor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MethodValidationPostProcessor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>目标类必须使用 Spring 的 <code>@Validated</code> 注解，同时目标类依赖 AOP 代理，否则不能正常工作。</p>
</li>
</ul>
</li>
</ul>
<h3 id="1-1-2-Resolving-Codes-to-Error-Messages"><a href="#1-1-2-Resolving-Codes-to-Error-Messages" class="headerlink" title="1.1.2. Resolving Codes to Error Messages"></a>1.1.2. Resolving Codes to Error Messages</h3><ul>
<li>如果需要使用 <code>MessageSource</code> 输出错误信息，可以使用在拒绝字段时提供的 error code。</li>
<li><code>MessageCodesResolver</code> 决定 <code>Error</code> 注册哪个 error code 。</li>
<li>默认解析器 <code>DefaultMessageCodesResolver</code> 不仅注册 reject 时提供的 message 与 code，也包括传递的字段名。</li>
</ul>
<h2 id="1-2-Bean-Manipulation-and-the-BeanWrapper"><a href="#1-2-Bean-Manipulation-and-the-BeanWrapper" class="headerlink" title="1.2. Bean Manipulation and the BeanWrapper"></a>1.2. Bean Manipulation and the <code>BeanWrapper</code></h2><p><a target="_blank" rel="noopener" href="https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#validation">reference</a></p>
<ul>
<li><p>Spring 定义一个 <a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/api/java/beans/package-summary.html">bean</a> 的原则：一个类有默认的构造器，对于其属性要有其 setter 与 getter 。</p>
</li>
<li><p>beans package 中重要的接口 <code>BeanWrapper</code> 提供了访问设置 bean 各种属性的功能。</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">BeanWrapper company = <span class="keyword">new</span> BeanWrapperImpl(<span class="keyword">new</span> Company());</span><br><span class="line"><span class="comment">// setting the company name..</span></span><br><span class="line">company.setPropertyValue(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;Some Company Inc.&quot;</span>);</span><br><span class="line"><span class="comment">// ... can also be done like this:</span></span><br><span class="line">PropertyValue value = <span class="keyword">new</span> PropertyValue(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;Some Company Inc.&quot;</span>);</span><br><span class="line">company.setPropertyValue(value);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ok, let&#x27;s create the director and tie it to the company:</span></span><br><span class="line">BeanWrapper jim = <span class="keyword">new</span> BeanWrapperImpl(<span class="keyword">new</span> Employee());</span><br><span class="line">jim.setPropertyValue(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;Jim Stravinsky&quot;</span>);</span><br><span class="line">company.setPropertyValue(<span class="string">&quot;managingDirector&quot;</span>, jim.getWrappedInstance());</span><br><span class="line"></span><br><span class="line"><span class="comment">// retrieving the salary of the managingDirector through the company</span></span><br><span class="line">Float salary = (Float) company.getPropertyValue(<span class="string">&quot;managingDirector.salary&quot;</span>);</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="1-2-1-Built-in-PropertyEditor-Implements"><a href="#1-2-1-Built-in-PropertyEditor-Implements" class="headerlink" title="1.2.1. Built-in PropertyEditor Implements"></a>1.2.1. Built-in <code>PropertyEditor</code> Implements</h3><p><a target="_blank" rel="noopener" href="https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#validation">reference</a></p>
<ul>
<li>Spring 使用 <code>PropertyEditor</code> 的概念来完成 <code>Object</code> 与 <code>String</code> 之间的转换。</li>
<li>常用使用场景：<ul>
<li>给 bean 设置 properties。在 xml 给 bean 配置了 class property ，使用 <code>ClassEditor</code> 将 String 转成 Class 对象。</li>
<li>在 Spring MVC 中使用 <code>PropertyEditor</code> 解析 HTTP 请求参数（可手动绑定 <code>CommandController</code> 所有子类）。</li>
</ul>
</li>
</ul>
<h4 id="1-2-1-1-Spring-内置的-PropertyEditor-实现"><a href="#1-2-1-1-Spring-内置的-PropertyEditor-实现" class="headerlink" title="1.2.1.1. Spring 内置的 PropertyEditor 实现"></a>1.2.1.1. Spring 内置的 <code>PropertyEditor</code> 实现</h4><p><a target="_blank" rel="noopener" href="https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#validation">reference</a></p>
<p>其中有默认注册为 <code>BeanWrapperImpl</code> ，Spring 将自动使用这些组件实现 String 与 各个 type 的转换。</p>
<h4 id="1-2-1-2-注册自定义-PropertyEditor"><a href="#1-2-1-2-注册自定义-PropertyEditor" class="headerlink" title="1.2.1.2. 注册自定义 PropertyEditor"></a>1.2.1.2. 注册自定义 <code>PropertyEditor</code></h4><p><a target="_blank" rel="noopener" href="https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#validation">reference</a></p>
<p>两种注册方式：</p>
<ol>
<li>当有获取到 BeanFactory reference 时，使用 ConfigurableBeanFactory 其 <code>registerCustomEditor()</code> 方法将自定义的 PropertyEditor 注册进来（不推荐）。</li>
<li>使用名为 <code>CustomEditorConfigurer</code> 的 bean factory post-processor，可使用注册 bean 方式注册，可设置其内置属性。</li>
</ol>
<ul>
<li><p>实现一个 PropertyEditor</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExoticTypeEditor</span> <span class="keyword">extends</span> <span class="title">PropertyEditorSupport</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAsText</span><span class="params">(String text)</span> </span>&#123;</span><br><span class="line">        setValue(<span class="keyword">new</span> ExoticType(text.toUpperCase()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>将 editor 注册到配置器中</p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.beans.factory.config.CustomEditorConfigurer&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;customEditors&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;example.ExoticType&quot;</span> <span class="attr">value</span>=<span class="string">&quot;example.ExoticTypeEditor&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="1-2-1-2-1-使用-PropertyEditorRegistrar"><a href="#1-2-1-2-1-使用-PropertyEditorRegistrar" class="headerlink" title="1.2.1.2.1. 使用 PropertyEditorRegistrar"></a>1.2.1.2.1. 使用 <code>PropertyEditorRegistrar</code></h5><ul>
<li>在不同场景需要使用同一系列的 editor 时更适合此注册器。</li>
<li>与接口 <code>CustomEditorConfigurer</code> 连用，将 PropertyEditorRegistrar 实例注册到 CustomerEditorConfigurer 中，editor 可轻松地共享到 <code>DataBinder</code> 与 Spring MVC Controller。同时，这样操作在每次调用 PropertyEditor 时都创建一个新的实例，而避免了同步。</li>
</ul>
<h2 id="1-3-Spring-Type-Conversion"><a href="#1-3-Spring-Type-Conversion" class="headerlink" title="1.3. Spring Type Conversion"></a>1.3. Spring Type Conversion</h2><p><a target="_blank" rel="noopener" href="https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#beans-beans-conversion-customeditor-registration">reference</a></p>
<h3 id="1-3-1-Converter-SPI"><a href="#1-3-1-Converter-SPI" class="headerlink" title="1.3.1. Converter SPI"></a>1.3.1. Converter SPI</h3><ul>
<li>函数式接口， <code>Converter&lt;S, T&gt;</code></li>
</ul>
<h3 id="1-3-2-ConverterFactory"><a href="#1-3-2-ConverterFactory" class="headerlink" title="1.3.2. ConverterFactory"></a>1.3.2. ConverterFactory</h3><ul>
<li>使用 <code>ConverterFactory&lt;S, R&gt;</code> 可以实现提供将一个类型转换成多个类型的 不同的转换器。</li>
</ul>
<h3 id="1-3-3-GenericConverter"><a href="#1-3-3-GenericConverter" class="headerlink" title="1.3.3. GenericConverter"></a>1.3.3. GenericConverter</h3><p>相对于 Converter 提供了更复杂灵活的转换功能。针对转换多个目标 类型。</p>
<h3 id="1-3-4-ConditionalGenericConverter"><a href="#1-3-4-ConditionalGenericConverter" class="headerlink" title="1.3.4. ConditionalGenericConverter"></a>1.3.4. ConditionalGenericConverter</h3><ul>
<li>联合了 <code>GenericConverter</code> 和 <code>ConditionalConverter</code> 两个接口而成，可以指定目标字段进行转换。</li>
<li>可以给 GenericConverter 加上条件，指定允许哪些转换，哪些不允许；</li>
</ul>
<h3 id="1-3-5-Formatting"><a href="#1-3-5-Formatting" class="headerlink" title="1.3.5. Formatting"></a>1.3.5. Formatting</h3><h3 id="1-3-6-The-ConversionService-API"><a href="#1-3-6-The-ConversionService-API" class="headerlink" title="1.3.6. The ConversionService API"></a>1.3.6. The <code>ConversionService</code> API</h3><p><a target="_blank" rel="noopener" href="https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#core-convert-ConversionService-API">reference</a></p>
<ul>
<li>大部分 <code>ConversionService</code> 实现了 <code>ConverterRegistry</code> ，这就提供了注册 Converter 的 SPI。内部实现将 conversion 工作委托给注册的 converter 。</li>
<li><code>GenericConversionService</code> 覆盖了大部分 converter 使用场景</li>
<li><code>ConversionServiceFactory</code> 提供工厂创建常用 <code>ConversionService</code> 。</li>
</ul>
<h3 id="1-3-7-配置-ConversionService"><a href="#1-3-7-配置-ConversionService" class="headerlink" title="1.3.7. 配置 ConversionService"></a>1.3.7. 配置 <code>ConversionService</code></h3><ul>
<li>使用默认的 <code>ConversionServiceFactoryBean</code> 为容器默认转换器服务，其提供了基础数据转换器（详见 <code>&#123;@link DefaultConversionService # addDefaultConverters()&#125;</code>）。</li>
<li>添加自定义转换器</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;conversionService&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;org.springframework.context.support.ConversionServiceFactoryBean&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;converters&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;example.MyCustomConverter&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>使用默认转换复合类型数据（集合转集合）<a target="_blank" rel="noopener" href="https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#core-convert-ConversionService-API">reference</a></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">DefaultConversionService cs = <span class="keyword">new</span> DefaultConversionService();</span><br><span class="line"></span><br><span class="line">List&lt;Integer&gt; input = ...</span><br><span class="line">cs.convert(input,</span><br><span class="line">    TypeDescriptor.forObject(input), <span class="comment">// List&lt;Integer&gt; type descriptor</span></span><br><span class="line">    TypeDescriptor.collection(List.class, TypeDescriptor.valueOf(String.class)));</span><br></pre></td></tr></table></figure>

<ul>
<li>使用 <code>DefaultConversionService</code> 默认添加各个转换器到 Spring 容器中</li>
<li>添加自定义 Converter 到其中，使用时直接调用 convert 方法，其在添加时是将各个 converter 放入一个指定 map 中，在使用时再 get 到相应的目标 converter 再再使用（这里可以看出来，再复杂的系统设计，最后都回归到了数据结构中）。</li>
</ul>
<p><em>规律：一个工具有多个功能时就可以集成到一个 service 组件中：Converter -&gt; ConverterService。再将一个组件注册到 IoC 容器中，在容器中任何位置自动装配上此组件即可使用。</em></p>
<h2 id="1-4-Spring-Field-Formatting"><a href="#1-4-Spring-Field-Formatting" class="headerlink" title="1.4. Spring Field Formatting"></a>1.4. Spring Field Formatting</h2><p><a target="_blank" rel="noopener" href="https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#format">reference</a></p>
<p>formatting 是 converting 的一个子集。在客户端环境（web 应用或桌面应用），需要将 <code>String</code> 与各个类型互转，同时也需要将 String 本地化。这个格式化的过程在 core.convert.Converter SPI 并没有直接解决。Spring 3 中引入 Formatting SPI 提供了可选的 <code>PropertyEditor</code>实现来完成格式化。</p>
<ul>
<li><code>Formatter</code> 接口实现了 Printer 与 Parser 两个接口。</li>
</ul>
<h3 id="1-4-1-注解驱动-Formatting"><a href="#1-4-1-注解驱动-Formatting" class="headerlink" title="1.4.1. 注解驱动 Formatting"></a>1.4.1. 注解驱动 Formatting</h3><ul>
<li><code>AnnotationFormatterFactory&lt;? extend Annotation&gt;</code> 实现此接口，使用注解指定类中字段格式化。常用注解所在包： <code>org.springframework.format.annotation</code></li>
</ul>
<h3 id="1-4-2-拓展-Formatting-注册"><a href="#1-4-2-拓展-Formatting-注册" class="headerlink" title="1.4.2. 拓展 Formatting 注册"></a>1.4.2. 拓展 Formatting 注册</h3><ol>
<li>使用 FormatterRegistry SPI，其中可以提供多种类型的 formatter 注册包括注解指定字段、直接指定字段类型，最终 formatter 根据其 parser 与 printer 转换成两个 converter 注册到 conversionService 中</li>
</ol>
<h2 id="1-5-Spring-MVC-中配置序列化与反序列化的-Converter"><a href="#1-5-Spring-MVC-中配置序列化与反序列化的-Converter" class="headerlink" title="1.5. Spring MVC 中配置序列化与反序列化的 Converter"></a>1.5. Spring MVC 中配置序列化与反序列化的 Converter</h2><p>使用 JSR310 的序列化工具。</p>
<h3 id="1-5-1-序列化时间类型数据"><a href="#1-5-1-序列化时间类型数据" class="headerlink" title="1.5.1. 序列化时间类型数据"></a>1.5.1. 序列化时间类型数据</h3><p>默认情况下其添加的 jdk8 与 LocalDateTimeSerialize 等序列化工具使用的 formatter 常并不是我们想的结果，这时需要配置自己想要的 formatter。</p>
<ul>
<li>jdk time 包 DateTimeFormatter 有具体的构造方法。可直接使用其 Builder 类 ： <code>DateTimeFormatterBuilder</code> 。<ul>
<li><code>ResolveStyle</code> 指定 DateTime 解析模式：STRICT 严格按照日期来，超出则无效；SMART 智能模式，比如天超过当月最大天就到最大的；LENENT 宽容模式，超出边界也将被转换，比如：月份 15</li>
<li>指定 pattern ，在 builder 中 addPattern(String pattern) ，方法注释有对详细注释，其中有调用达到指定 pattern 字符等效方法说明。</li>
<li>builder.configure() 中最后将所有的 serializer 与 deserializer 都添加进 new SimpleModule 中，再将 simpleModule 注册到 objectMapper 中（所有的配置数据都会注册入 objectMapper），最后 build 方法即将此 objectMapper 返回供 <code>AbstractJackson2HttpMessageConverter</code> 构造（for Spring MVC）使用。</li>
</ul>
</li>
</ul>

    </div>

    
</div>
    <div class="footer" id="footer">
    <p><h4>Copyright © 2020 | Author: Kang | <a target="_blank" rel="noopener" href="https://github.com/Xunzhuo/hexo-theme-coder">Theme: Hexo-Coder</a></h4>
        <label class="el-switch el-switch-blue el-switch-sm" style="vertical-align: sub;">
            <input type="checkbox" name="switch" id="update_style">
            <span class="el-switch-style"></span>
        </label>
<!--         <script type="text/javascript">
        var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");
        document.write(unescape("%3Cspan id='cnzz_stat_icon_1278548644'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "v1.cnzz.com/stat.php%3Fid%3D1278548644%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
        </script> -->
    </p>
</div>
<input type="hidden" id="web_style" value="light">
<input type="hidden" id="valine_appid" value="NOsswOncKgc8HOxqo9oxIWlX-gzGzoHsz">
<input type="hidden" id="valine_appKey" value="z1FihjWEbS8uIfUQdmCtK7zz">

<script src="/libs/jquery.min.js"></script>


<script src="/libs/highlight/highlight.pack.js"></script>

<script src='//cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js'></script>

<script src="/js/js.js"></script>

<style type="text/css">
.v * {
    color: #698fca;
}

.v .vlist .vcard .vhead .vsys {
    color: #3a3e4a;
}

.v .vlist .vcard .vh .vmeta .vat {
    color: #638fd5;
}

.v .vlist .vcard .vhead .vnick {
    color: #6ba1ff;
}

.v a {
    color: #8696b1;
}

.v .vlist .vcard .vhead .vnick:hover {
    color: #669bfc;
}
</style>

    <script type="text/javascript" color="173,174,173" opacity='1' zIndex="-2" count="99" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
</body>
</html>