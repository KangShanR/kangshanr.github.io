<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>KangShan</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="This is kang&apos;s website.">
<meta property="og:type" content="website">
<meta property="og:title" content="KangShan">
<meta property="og:url" content="https://kangshanr.github.io/index.html">
<meta property="og:site_name" content="KangShan">
<meta property="og:description" content="This is kang&apos;s website.">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="KangShan">
<meta name="twitter:description" content="This is kang&apos;s website.">
<link rel="publisher" href="kangshan9988@gmail.com">
  
    <link rel="alternate" href="/atom.xml" title="KangShan" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">KangShan</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Welcome to my website.</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://kangshanr.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-mybatis" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/31/mybatis/" class="article-date">
  <time datetime="2017-08-31T05:12:34.000Z" itemprop="datePublished">2017-08-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/java/">java</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/31/mybatis/">Mybatis框架的应用与理解</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="mybatis框架的使用与理解"><a href="#mybatis框架的使用与理解" class="headerlink" title="mybatis框架的使用与理解"></a>mybatis框架的使用与理解</h2><h4 id="Mybatis与JDBC"><a href="#Mybatis与JDBC" class="headerlink" title="Mybatis与JDBC"></a>Mybatis与JDBC</h4><p><strong>概述：</strong></p>
<ol>
<li>MyBatis是一个半自动的面向sql的orm框架；</li>
<li>JDBC全称：java database connectivity，是java封装在在java.sql包里的API，其设计目的在于连接数据库，通过java语言实现sql查询语言在数据库中的操作；</li>
<li>Mybatis就是对JDBC的封装，使其操作数据库更为灵活，更多的数据与实体之间的映射交给配置文件来实现；</li>
<li><strong>JDBC</strong>作为java连接数据库的底层框架，<ol>
<li><strong>实现数据库连接功能的步骤：</strong><ol>
<li>加载驱动</li>
<li>获取数据库连接</li>
<li>准备语句（获取状态对象）</li>
<li>执行语句</li>
<li>处理结果集</li>
<li>关闭数据库（释放资源）</li>
<li>异常处理</li>
</ol>
</li>
<li>可以看到在整个流程中的<strong>JDBC功能实现的缺陷</strong>：<ol>
<li>jdbc的硬编码不方便维护，需要不停地连接、释放数据库资源；</li>
<li>参数绑定在硬编码中，查询条件不定，修改语句也不方便；</li>
</ol>
</li>
<li>所以，就有了MyBatis存在的必要；</li>
</ol>
</li>
</ol>
<hr>
<h3 id="MyBatis的实现"><a href="#MyBatis的实现" class="headerlink" title="MyBatis的实现"></a>MyBatis的实现</h3><p><strong>在一个工程中要使用MyBatis框架：</strong></p>
<ol>
<li>将MyBatis的核心包、依赖包引入。如果是Maven项目，直接在pom.xml中引入依赖：<pre><code>&lt;dependencies&gt;
&lt;!-- 实现连接数据库的包 --&gt;
  &lt;dependency&gt;
      &lt;groupId&gt;mysql&lt;/groupId&gt;
      &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
      &lt;version&gt;5.1.37&lt;/version&gt;
  &lt;/dependency&gt;
&lt;!-- 日志记录的包 --&gt;
  &lt;dependency&gt;
      &lt;groupId&gt;log4j&lt;/groupId&gt;
      &lt;artifactId&gt;log4j&lt;/artifactId&gt;
      &lt;version&gt;1.2.17&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
      &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
      &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;
      &lt;version&gt;1.7.21&lt;/version&gt;
  &lt;/dependency&gt;
&lt;!-- 实现测试包 --&gt;
  &lt;dependency&gt;
      &lt;groupId&gt;junit&lt;/groupId&gt;
      &lt;artifactId&gt;junit&lt;/artifactId&gt;
      &lt;version&gt;4.12&lt;/version&gt;
      &lt;scope&gt;test&lt;/scope&gt;
  &lt;/dependency&gt;
  &lt;!-- mybatis核心包 --&gt;
&lt;dependency&gt;
        &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
        &lt;artifactId&gt;mybatis&lt;/artifactId&gt;
        &lt;version&gt;3.4.2&lt;/version&gt;
&lt;/dependency&gt;
  &lt;/dependencies&gt;
</code></pre></li>
<li><p>引入相关的jar包后，就可以对mybatis进行配置：</p>
<ol>
<li><p>mybatis.xml文件中，配置mybatis的标签是：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;  
&lt;!DOCTYPE configuration PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;
    &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;

&lt;configuration&gt;

    &lt;!-- 引入配置文件 --&gt;
    &lt;properties resource=&quot;jdbc.properties&quot; /&gt;

    &lt;!--自定义别名 --&gt;
    &lt;typeAliases&gt;
        &lt;!--定义单个别名 ,不区别大小写 --&gt;
        &lt;!-- &lt;typeAlias type=&quot;com.woniuxy.mybatis.entity.User&quot; alias=&quot;user&quot;/&gt; --&gt;
        &lt;!-- 批量定义别名，该包内所有的类的类名直接作为别名，不区分大小写 --&gt;
        &lt;package name=&quot;com.woniuxy.mybatis.entity&quot; /&gt;
    &lt;/typeAliases&gt;

    &lt;!-- jdbc的配置信息 --&gt;
    &lt;environments default=&quot;development&quot;&gt;
        &lt;environment id=&quot;development&quot;&gt;
            &lt;!-- 配置事务管理器 --&gt;
            &lt;transactionManager type=&quot;JDBC&quot; /&gt;
            &lt;!-- 数据库连接池 --&gt;
            &lt;dataSource type=&quot;POOLED&quot;&gt;
                &lt;property name=&quot;driver&quot; value=&quot;${jdbc.driver}&quot; /&gt;
                &lt;property name=&quot;url&quot; value=&quot;${jdbc.url}&quot; /&gt;
                &lt;property name=&quot;username&quot; value=&quot;${jdbc.username}&quot; /&gt;
                &lt;property name=&quot;password&quot; value=&quot;${jdbc.password}&quot; /&gt;
            &lt;/dataSource&gt;
        &lt;/environment&gt;
    &lt;/environments&gt;

    &lt;!-- 映射资源 --&gt;
    &lt;mappers&gt;
        &lt;mapper resource=&quot;mappings/Users.xml&quot; /&gt;
        &lt;mapper resource=&quot;mappings/UserMapper.xml&quot; /&gt;
    &lt;/mappers&gt;

&lt;/configuration&gt;
</code></pre><ul>
<li>其根标签是：<code>&lt;configuration&gt;</code></li>
<li>解析上述各标签：<ul>
<li>properties:属性文件的引入，将java属性文件引入到该配置文件中，如上所述：引入了jdbc.properties文件，就可以在配置数据源属性时，通过点位符&amp;｛｝来获取到装配进来的属性文件中的属性值；</li>
<li>typeAliases:别名的设定，可以指定单个类的别名，也可以使用子标签<code>package</code> 指定整个包的别名为类的simpleName;</li>
<li>environments配置中，除了配置了JDBC数据库连接信息(数据源类型：POOLED)外,还得设定事务管理器类型：JDBC；</li>
<li>mappers:映射各个实体类或映射类配置文件到此配置文件中去；</li>
</ul>
</li>
</ul>
</li>
</ol>
<ul>
<li><p>mappers中的配置文件：</p>
<ul>
<li><p>Users.xml文件是指定了这个user类与数据库中操作的方法，包括这些方法的参数与返回值类型；</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE mapper
    PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;
    &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;

&lt;mapper namespace=&quot;test2&quot;&gt;

    &lt;!-- 根据id获取用户信息 --&gt;
    &lt;select id=&quot;findUserById&quot; parameterType=&quot;int&quot; resultType=&quot;User&quot;&gt;
        SELECT * FROM t_user WHERE ID = #{id}
    &lt;/select&gt;

    &lt;!-- 根据用户名获取用户列表 --&gt;
    &lt;select id=&quot;findUserByUsername&quot; parameterType=&quot;string&quot; resultType=&quot;User&quot;&gt;
        SELECT * FROM t_user WHERE user_name like &apos;%${value}%&apos;
    &lt;/select&gt;

    &lt;!-- 添加用户数据 --&gt;
    &lt;insert id=&quot;saveUserInfo&quot; parameterType=&quot;User&quot;&gt;
        &lt;!-- 使用selectkey返回插入数据的id --&gt;
        &lt;selectKey keyColumn=&quot;id&quot; keyProperty=&quot;id&quot; resultType=&quot;int&quot; order=&quot;AFTER&quot;&gt;
            SELECT LAST_INSERT_ID()
        &lt;/selectKey&gt;
        &lt;!-- 如果主键使用uuid，则可以通过下面方法把id转出 --&gt;
        &lt;!-- &lt;selectKey keyProperty=&quot;id&quot; resultType=&quot;string&quot; order=&quot;BEFORE&quot;&gt;
            SELECT UUID()
        &lt;/selectKey&gt; --&gt;
        INSERT INTO t_user(user_name,cnname,sex,mobile,email,note) VALUES 
        (#{user_name},#{cnname},#{sex},#{mobile},#{email},#{note})
    &lt;/insert&gt;

    &lt;!-- 删除数据 --&gt;
    &lt;delete id=&quot;deleteUserById&quot; parameterType=&quot;int&quot;&gt;
        DELETE from t_user where id=#{value}
    &lt;/delete&gt;

    &lt;!-- 更新数据 --&gt;
    &lt;update id=&quot;updateUserInfo&quot; parameterType=&quot;User&quot;&gt;
        UPDATE t_user SET
        user_name=#{user_name},cnname=#{cnname},sex=#{sex},mobile=#{mobile},email=#{email},note=#{note} 
        WHERE id=#{id}
    &lt;/update&gt;

&lt;/mapper&gt;
</code></pre><ul>
<li><code>#{}</code>与<code>${}</code>的区别：<ul>
<li><code>#{}</code><ul>
<li>表示占位符号，相当于实现了JDBC中的paparedStatement占位符的作用，也就实现了防止sql注入；</li>
<li>同时实现了java类型与jdbc类型转换，可以接收简单类型值与pojo属性值；</li>
<li>如果传输单个简单类型值，｛｝中可以是value或其它名称；</li>
</ul>
</li>
<li><code>${}</code><ul>
<li>表示sql字符串拼接，也就是将｛｝中的内容拼接在sql中且不进行jdbc类型转换；</li>
<li>可以接收简单类型值或pojo值，如果是简单类型值｛｝中只能是’value’;</li>
</ul>
</li>
</ul>
</li>
<li><p>文档头可以看出这是mabatis3映射的定义文档类型，所以其根标签为<code>mapper</code>，其中各子标签或属性：</p>
<ul>
<li>namespace属性，指定其命名空间，这样在其它地方要调用此配置文件中的各语句时，就需要通过这个命名空间来访问到此文档中定义id的各个语句，通过session对象的方法来调用时，这些语句就作为参数执行方法：`session.selectOne(“findUserById()”,user)；</li>
<li><p>session的来源：</p>
<pre><code>/**
 * 测试前的预备工作
 */
@Before
public void before(){
    System.out.println(Before.class);

    try {
        // 读入mybatis配置文件到输入流中
        is = Resources.getResourceAsStream(&quot;mybatis.xml&quot;);
        factoryBuilder = new SqlSessionFactoryBuilder();
        //使用输入流创建sqlSessionFactory
        factory = factoryBuilder.build(is);
        //打开sqlSession
        session = factory.openSession();
    } catch (IOException e) {
        e.printStackTrace();
    }
}
</code></pre><ul>
<li>上述代码是利用junit包实现了测试功能，@Before注解标这个方法在@Test方法之前运行，从该方法就可以看出myBaitis的运行流程：<ul>
<li>将mybatis.xml配置文件读放流中，再使用sessionFactoryBuilder对该流进行创建工厂（抽象工厂模式）；</li>
<li>调用工厂的openSession()方法打开会话，获得sesison实例；</li>
<li>操作数据库最后一步就是调用session对象的方法：<code>List&lt;User&gt; users = session.selectList(&quot;test.findUserByUsername&quot;, &quot;k&quot;);</code><ul>
<li>这儿的test就是之前指定的namespace，这儿指定的id的语句执行，并将另外的参数传入，形成完整的sql语句；</li>
</ul>
</li>
</ul>
</li>
<li>这个流程是最初级的，而我们现实中常常不使用这样的形式，而使用接口来将所有<strong>方法的调用都交由接口来实现：</strong><ul>
<li>在获取到session时，就通过<strong>session.getMapper(Class<t> mapper)方法来获取到相关的mapper接口的对象</t></strong>，而在使用过程中，就直接调用这个接口对象的方法（方法执行时就调用相应的语句执行），这个方法与语句之间映射就由指定了nameSpace的xml配置文件来实现，这种方法实现原理叫Mapper动态代理；</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<ul>
<li><strong>从上面的例子就可以看出Mybatis解决了的jdbc的问题：</strong><ul>
<li>数据库的链接的创建与释放者造成系统资源的浪费，而使用数据库连接池就可以此问题，在Mybatis的配置中设置；</li>
<li>sql语句写在java代码中造成的不易维护，而Mybatis就将这些sql语句配置在相应的配置文件中，这样就与java代码实现了分离；</li>
<li>使用映射好的java对象来作为sql语句的statemente的参数，而不用像在jdbc的执行方法中定义输入参数的类型；</li>
<li>对于结果集的解析在JDBC中需要一层层遍历，并将各个属性封装到entity中再装入集合中。Mybatis将这些封装好，直接将结果映射到java对象中；</li>
</ul>
</li>
<li>同时，上面例子并没有在持久层操作，也就是DAO层并没有进行开发，直接使用在TEST中进行调用抽象工厂的构造方法来构造工厂与sqlSession，再用sqlSession对象的方法，sqlSession的方法中调用配置好的sql语句与参数；</li>
<li>如果要实现持久层的开发不过是把上面构造SqlSessionFactory/SqlSession的方法封装进Dao类中实现；</li>
</ul>
<hr>
<h3 id="使用Mapper代理开发"><a href="#使用Mapper代理开发" class="headerlink" title="使用Mapper代理开发"></a>使用Mapper代理开发</h3><h4 id="概述："><a href="#概述：" class="headerlink" title="概述："></a>概述：</h4><ul>
<li><strong>动态代理开发</strong>，就是让生成Mapper对象的这个过程交给SqlSession对象的getMapper（Class<t> mapper)方法，这时的SqlSession可以理解为工厂，也就是通过了工厂来构造获取Mapper接口的对象；</t></li>
<li>Mapper对象就是Mapper接口的实例，这个接口与写好相关的mapper.xml配置文件相关联，Mybatis就用这个接口作为代理与被代理的mapper的公共接口，这个对象的方法执行时就与相关联的Mapper.xml配置文件里的sql语句来执行sql方法；</li>
<li>Mapper接口与Mapper.xml配置文件相关联的规则（此规则由Mybatis规定，符合此规则便形成关联）：<ul>
<li>Mapper.xml文件中的namespce与mapper接口的类路径相同；</li>
<li>Mapper接口方法名和Mapper.xml中定义的每个statement的id相同；</li>
<li>接口方法的输入参数类型和配置文件中的sql的parameterType的类型相同；</li>
<li>接口方法的返回数据类型与配置文件中的resultType类型相同的；</li>
</ul>
</li>
<li>实现代理开发就意味着之前的session方法执行都交给这个Mapper对象，所有的操作方法都由这个接口定义，调用这个方法就只用传入定义的参数类型，这也就<strong>实现了由Mapper对象的方法来代理SqlSession对象中的操作数据库的方法</strong>(<em>这儿涉及到代理<a href="http://kangshan.oschina.io/2016/06/13/DesignPattern/" title="设计模式" target="_blank" rel="external">设计模式</a>的理解</em>)，相对于直接使用SqlSession的各种执行方法更为简便；<ul>
<li><strong>动态代理开发中的小点：</strong><ul>
<li>动态代理在使用时，Mybatis会生成一个动态代理对象，至于这个动态代理对象会调用SqlSession的的selectOne()方法还是selectList()方法根据定义的mapper接口方法的返回值决定，如果返回List则调用selectList()方法，如果返回单个对象就调用selectOne()方法；</li>
<li>使用mapper代理开发就不用写mapper接口实现类，输入参数也可以直接使用map对象或pojo对象，保证了dao的通用性；</li>
</ul>
</li>
</ul>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kangshanr.github.io/2017/08/31/mybatis/" data-id="cj70r8fx0000t6cqn0x0eq5vx" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Mybatis/">Mybatis</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/">java</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-singleton_pattern" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/29/singleton_pattern/" class="article-date">
  <time datetime="2017-08-29T04:54:30.000Z" itemprop="datePublished">2017-08-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/java/">java</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/29/singleton_pattern/">设计模式之单例模式</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="设计模式之单例模式"><a href="#设计模式之单例模式" class="headerlink" title="设计模式之单例模式"></a>设计模式之单例模式</h3><blockquote>
<p>单例模式是设计模式最常用到的模式之一，从字面上理解就是，该对象类只产生一个实例。这样做的理由在于开发过程中很多类（比如：管理类）都只用一个实例就够了，这样做也更节省资源。但是项目开发做会有一个多线程的问题，也就是当多个线程访问同一个类的单例时，这时会产生线程安全问题，为解决这个问题，单例模式分成了6种不同类型。</p>
</blockquote>
<ul>
<li>单例模式的<strong>设计目的</strong>就在于：不想让一个全局使用的类频繁地被创建再销毁其实例，要达到这样的效果就让其构造函数不能被不停地调用，也就是<strong>私有化其构造函数</strong>；</li>
<li>单例模式的6种类型：<ul>
<li>非线程安全的懒汉式<pre><code>public class UserManager{
    //静态单例
    private static UserManager ins;
    //私有化构造函数
    private UserManager(){}
    //获取静态单例的方法
    public static UserManager getIns(){
        if(ins == null){
            ins = new UserManager();
        }
        return ins;
    }
    //其他的执行方法
｝
</code></pre><ul>
<li>这种类型的单例就是没有考虑线程安全的单例，之所以叫“懒汉式”在于其实现了这个单例的懒加载，也就是第一次使用时才会实例化这个单例；</li>
<li>其缺陷在于当多线程同时第一次访问这个单例时，会构造出多个单例来，也就是说严格上讲它并不单例模式；</li>
</ul>
</li>
<li>线程安全的懒汉式<pre><code>public class UserManager{
    //静态单例
    private static UserManager ins;
    //私有化构造函数
    private UserManager(){}
    //获取静态单例的方法
    public static synchronized UserManager getIns(){
        if(ins == null){
            ins = new UserManager();
        }
        return ins;
    }
    //其他的执行方法
｝
</code></pre><ul>
<li>这处线程安全的懒汉式只是简单地在获取单例的方法上加上synchronized同步锁，同时也实现了懒加载；</li>
<li>这样做缺陷在于效率上的低下，想要获取这个类的单例所有线程都得等待上一个线程释放资源；<br>-饿汉式<br>  public class UserManager{<pre><code>//静态单例定义为类成员
private static UserManager ins = new UseManager();
//私有化构造函数
private UserManager(){}
//获取静态单例的方法
public static UserManager getIns(){
    return ins;
}
//其他的执行方法
</code></pre>  ｝</li>
<li>这种单例定义为类成员，也就是类加载时就将这个单例初始化完成，未实现懒加载，会造成资源的浪费；</li>
<li>并没有使用同步锁而实现了多线程只访问同一个实例，效率上更高；</li>
</ul>
</li>
<li>双检锁（双重校验锁），DCL（double-checked locking)<pre><code>public class UserManager{
    //静态单例
    private static UserManager ins;
    private Object lock = new Object();
    //私有化构造函数
    private UserManager(){}
    //获取静态单例的方法
    public static UserManager getIns(){
        if(ins == null){  //第一次检查
            synchronized(lock){  //保证不产生多余的实例
                if(ins == null){  //第二次检查
                    ins = new UserManager();
                }
            }
        }
        return ins;
    }
    //其他的执行方法
}
</code></pre><ul>
<li>这种类型就实现了高性能与懒加载，逻辑上也相对复杂一点；</li>
<li>两次检验都放在getIns方法内，第一次校验确保只有ins实例第一次被创建时进入到同步锁块中，也就是多线程下会有多个线程进入到这一步，这时最先拿到控制权的线程构造实例后，其他的线程不能再构造实例了，所以就得在同步锁中再次进入第二次检验了；</li>
</ul>
</li>
<li>静态内部类（登记式）<pre><code>public class UserManager{
    //定义私有的静态内部类
    private static class ManagerHolder{
        //定义私有的静态属性，其值为我们想要的实例
        private static final UserManager INSTANCE = new UserManager();
    }
    //私有化构造函数
    private UserManger(){}
    //获取单例的方法
    public static UserManager getIns(){
        return ManagerHolder.INSTANCE; 
    }
}
</code></pre><ul>
<li>这种类型的单例模式效果和双检锁效果差不多，同样实现了懒加载，且没有使用同步锁；</li>
</ul>
</li>
<li>枚举<pre><code>public enum UserManager{
    //单例
    INSTANCE;
    //其他的方法
}
</code></pre><ul>
<li>这种方式是目前实现单例的最佳方法，但目前还没推广（jdk1.5之后才加入enum)，更简洁，自动支持序列化机制，绝对防止多次实例化；</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<blockquote>
<p>6种单例模式中，前两种懒汉模式不推荐使用，第一种并非纯正的单例模式，第二种懒汉模式在多线程中效率低下，更不推荐，只要进入getIns方法就得等待上一个线程释放控制权；<br>当对反序列化机制有严格要求时，就使用枚举方式；<br>当要明确使用lazy loading时，就使用静态内部类方式或者双检锁方式；</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kangshanr.github.io/2017/08/29/singleton_pattern/" data-id="cj70r8fx3000v6cqnmfqob4id" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/">java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/单例模式/">单例模式</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/线程安全/">线程安全</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-20170829IgotMeeting" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/29/20170829IgotMeeting/" class="article-date">
  <time datetime="2017-08-28T18:04:38.000Z" itemprop="datePublished">2017-08-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/job/">job</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/29/20170829IgotMeeting/">得到例会：关于找工作</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="得到例会"><a href="#得到例会" class="headerlink" title="得到例会"></a>得到例会</h3><p>8/29/2017 9:41:18 PM<br>今天得到例会，快刀谈到找他招人的感想，觉得对自己很有用，记录下并找到之前他们拉过的清单，这儿一并引用过来，谈谈自己的看法:</p>
<p>快刀：</p>
<ol>
<li>找交互设计大咖后，站在一个招技术人才的业务管理角度上谈谈自己对来聘人员的几点看法：<ol>
<li>非应届生一定要了解应聘的公司，一定要做充足的准备；</li>
<li>自我介绍的作用：抓住重点，不能陷入自传；</li>
<li>诚实：圈子内信息透明；</li>
<li>为什么想离开？说前任公司坏话只会损坏自己形象；</li>
<li>问问题：跟以后的工作做了解的问题才是王道，关于细节上的五险一金、加班费、各种福利，这些问题都不是问业务主管的回答的；</li>
</ol>
</li>
</ol>
<hr>
<p><em>快刀与娘娘分别在罗辑思维上推过关于找工作写简历的清单，个人认为很有参考意义，这儿一并贴出来：</em></p>
<h4 id="快刀："><a href="#快刀：" class="headerlink" title="快刀："></a>快刀：</h4><blockquote>
<p><strong>关于如何准备一份制胜简历的清单</strong><br>引言：简历是公司了解求职者的第一个途径，也是求职者获取工作的敲门砖。可是，有多少人明明很优秀，却败给了一份不合格的简历？</p>
<ol>
<li><p>简历是你的第一份产品，一定要认真对待，大方得体是王道。从招聘网站下载一个垃圾模板，随便填一大堆无用的信息，谁能相信你会认真对待自己的工作？</p>
</li>
<li><p>贴照片要谨慎，只能选择清晰的大头证件照。绝不要贴游客照和婚纱照，谁知道哪个是求职的。也不要工作10年了，还贴高中的准考证照片。</p>
</li>
<li><p>除了没有任何实习经验的在校生，删掉自己在社团、学生会、班级、寝室里获得的各种奖励。它们除了告诉别人你很嫩之外，没有任何用。</p>
</li>
<li><p>要让别人从简历中看出你的经历和核心竞争力。最好做到逻辑清晰无废话，能一张纸写完绝不用两张。</p>
</li>
<li><p>个人资料的必备字段是：姓名、年龄、电话、邮箱、毕业学校。不会有任何一家正经公司，希望在简历里看到饮食口味、三围、罩杯之类的信息。</p>
</li>
<li><p>如果是做设计或产品的，简历只用一到两种字体，不要炫技。附带的作品集，保证有3-5个能代表最高水平的就好，不要连练手的作品都放进来。东西越多，机会越少。</p>
</li>
<li><p>不能加分的东西就会减分。越长的简历，越容易出错。例如，你是曼联球迷，你觉得面试官说“我也是”的机会很大。但可能初筛时，就被一个迷恋阿森纳的HR砍了。与工作无关的爱好，一笔带过，不要展开。</p>
</li>
<li><p>自我评价不要超过1条微博的长度。写800字那是高考作文，没人想看你给自己写的自传。</p>
</li>
<li><p>别作死。作死会让别人记住你，但是并不会让人招你。5年前，我在老东家时，收到过一封让我至今仍刻骨铭心的简历。邮件第一句话是，“其实我并不喜欢你们公司”，不喜欢你投简历干什么。</p>
</li>
<li><p>不要一遍又一遍的在简历里强调“我什么都不会，但是我很努力，我可以学”。活了20多年都没学会，凭什么相信你入职就能学会？</p>
</li>
<li><p>凡是列了一大堆精通，里面还有Office的，几乎都会被刷。正如凡是写精通Excel的，真正问起来，懂透视表与各种公式的，基本没有。</p>
</li>
<li><p>附件除了Word版本，最好再附一个图片或者PDF版本。附件名字不要用“个人简历”或者“我的简历”，设想一下面试官电脑里有几十份“我的简历”的情形。用“应聘XX职位-X年工作经验-姓名”就足够了，也可以加上手机号。</p>
</li>
<li><p>作为职场中人，常备一份定期更新的简历是很必要的。不要等到看到机会再准备。定期根据实际情况来增减改删，只留下能代表自己最高实力的项目详情，其他项目一笔带过。</p>
</li>
<li><p>一岗一写，不要指望一份简历包打天下。针对每一个不同的公司或者岗位，单独改写简历。这就意味着不要海投简历，提前去媒体或社交网站上，了解这个公司的创始人或者高管，有助于你针对性改写。</p>
</li>
<li><p>用什么邮箱并不重要，但不要直接发一份带附件的空白邮件。邮件正文可以简单地描述一下自己的情况，但绝对不要空。</p>
</li>
<li><p>简历的核心作用是“争取到面试机会”，不要把自己的底牌都放在简历里。可以展示项目的成果数据，但是具体做法等到面试时再说。</p>
</li>
<li><p>最后提醒一句：不要逗贫。你不知道看简历的人笑点高低，一不注意会显得Low。</p>
</li>
</ol>
</blockquote>
<hr>
<h4 id="娘娘"><a href="#娘娘" class="headerlink" title="娘娘"></a>娘娘</h4><p><strong>清单｜拿下目标职位的16个必杀技</strong></p>
<blockquote>
<p>我是脱不花，罗辑思维CEO。</p>
<p>三年来，我坚持面试加入团队的每一位员工，平均每周至少有八个小时投入在面试上。我经常会发白日梦，看着眼前面试的人，琢磨如果我是Ta，此时此刻此情此景我会做什么。</p>
<p>时间久了，这套代入法，成了一种练习，一种面对不同问题的沙盘推演。很好玩，也是内观、自省的方式。</p>
<ol>
<li><p>我不会海量投递简历。我会把所有目标单位，按照自己的评价体系，分出梯队，一次只给特定的三四家公司投简历。一批如果失败，再启动下一批。</p>
</li>
<li><p>值得纳入评价体系的公司指标包括：公司成长性、能担任重要岗位的时间周期、薪酬、认识牛人的机会和频率、是否可以获得特别敬仰的师父、行业先进性、与我特长优势的匹配度、招收同龄同届人员的规模、公司整体的审美水平。</p>
</li>
<li><p>在投出简历之前，做足功课。研究这家公司的官网或者官微；认真阅读媒体动态，特别是创始人的讲话；体验这家公司的产品，尤其是非主力产品；上论坛或者贴吧看看相关评论，但不尽信。</p>
</li>
<li><p>我会把投出的每份简历，视为对这家公司的一次特定的沟通。没有标准简历一说，每份简历都是专门准备的。</p>
</li>
<li><p>我的简历核心内容只会有一页，其他皆为附件。简历首页是有助于建立信任的基本信息，要尽可能简洁。比如毕业院校、取得的最高荣誉、能为我背书的人、目标岗位、能力匹配，还有一张体面的标准照，而不是艺术照、生活照、自拍照。</p>
</li>
<li><p>简历里附件包括：我对公司的认同和对目标工作的理解，我以往的实际经验和相应的证明人，我的其他背景资料，主动提供社交媒体账号。</p>
</li>
<li><p>我在发送简历时，不会抖机灵，不会耍幽默。只会老老实实地写一封诚恳的邮件，把核心信息写在邮件正文里，而不是扔在附件里，用最小的格式把简历做成附件，发出。不会附上特别大的图片或者其他文件，也不会需要对方多次打开不同链接，而是一个可以快速打开、一次性看完的信息组合方式。</p>
</li>
<li><p>如果我极其渴望一份特定的工作，我会努力在投递简历前，做一些外围的示好。比如，结合自己的专业，帮这家公司做一些建设性的事情。</p>
</li>
<li><p>在面试时，进入公司现场，我会注意感受整体氛围：是否够开放？人与人之间是否有很多交流？每个人的状态看起来如何？我的直觉感受是怎样的？</p>
</li>
<li><p>面试时，我会用简洁的表达方式。有问，必有答。回答中经常引用和提及在做功课时获得的公司信息，表现出对公司的熟悉度。</p>
</li>
<li><p>表现出愿意学习的态度，但要表达能为公司做的贡献，而不是表达自己是来学习的。</p>
</li>
<li><p>对薪酬问题，用坦率的态度直接谈，有弹性，但也要有底线。弹性让我不错过长期来看的好机会，底线让我避免掉进坑里。如果在薪酬上做了较大让步，开口提出建设性的办法，比如，达到什么标准公司应该加薪。</p>
</li>
<li><p>当面试官让我发问时，绝对不问五险一金和年假制度（这种有的是机会私下问HR）。我会问几个好问题，比如：我会和谁一起工作？如果我遇到问题，我可以通过哪些方式获得指导？公司鼓励什么样的沟通方式？公司希望我在三个月左右能达到什么水平？在我以前，公司里最优秀的新人是什么样的？</p>
</li>
<li><p>精心打扮，但不过分。手机调整到无声。坐下就拿出笔记本。对面试官不要叫“某总”，张嘴就叫“老师”。</p>
</li>
<li><p>永远不要让对方知道，也许我手里还有其他Offer。这种故作紧俏的做法非常不体面。有经验的面试官不会因此紧张，反而怀疑你的诚意。</p>
</li>
<li><p>简历里不写错别字。面试时一直笑眯眯。</p>
</li>
</ol>
<p><em>Q: 上面的16条心法，你在求职时做到了几条，最后的结果如何？你又有什么独家的心法呢？</em></p>
</blockquote>
<hr>
<p><strong>我的体会：</strong><br><em>总的看来，上面几十条都是在这几点：</em></p>
<ol>
<li>我很靠谱，事情交到我手上可以有交代地被移交给他人；</li>
<li>我很善于合作，我善于连接；</li>
<li>我不笨；</li>
</ol>
<p><em>另外，在这次例会中，快刀的关于找工作只是很小的一部分，只是这一点对我很有触动，全展开来了。娘娘这次的干货中很有启发的一点是：学习了一定要强制输出，每周写一篇文章发布在自己的朋友圈中，不仅仅是让自己学到底，更能让自己在朋友圈中树立一个靠谱有建树的形象，这也是重要的社交货币。</em></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kangshanr.github.io/2017/08/29/20170829IgotMeeting/" data-id="cj70fi0h30006o8qniw3501bl" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/job/">job</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-今日无题" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/26/今日无题/" class="article-date">
  <time datetime="2017-08-26T14:19:02.000Z" itemprop="datePublished">2017-08-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/随笔/">随笔</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/26/今日无题/">无题</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>刚才重看了一遍《当幸福来敲门》，看到Chris在实习期间，为了促进与客户的联系与第一个客户去包厢看football game，这就便结识了一众上流的客户。</p>
<p>我便想到，这个时候要是我是他，我做得到吗？Chris很穷，比现阶段的我还穷，但他在与他的精英客户一起看比赛的过程中，一点也不含糊，用着最专业的语言与人交流铺垫后面的工作事务。而如果是我，我肯定会在内心深处认为自己干不了这个事。这也是一般人的的认知上的缺陷。大家都会认为自己不熟悉的东西都不是自己的东西，会直接把这些东西排除在自己的思考范围之外。Chris为什么能做到？为什么我有同样的境遇时，我会把所有松懈归因到外界？同时，我为什么会松懈？
        
          <p class="article-more-link">
            <a href="/2017/08/26/今日无题/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://kangshanr.github.io/2017/08/26/今日无题/" data-id="cj70fi0hr000so8qnlxw89wui" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/essay/">essay</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/观影无感/">观影无感</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-神片试撸《巴霍巴利王II》" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/25/神片试撸《巴霍巴利王II》/" class="article-date">
  <time datetime="2017-08-25T14:04:38.000Z" itemprop="datePublished">2017-08-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/观影无感/">观影无感</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/25/神片试撸《巴霍巴利王II》/">神片试撸《巴霍巴利王II》</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>今天晚上撸了一印度神片电影《巴霍巴利王II》，一部刺激荷尔蒙狂飙的电影，<br>一部用视觉效果与背景音乐带着剧情与逻辑飞的电影，让人看了想谈恋爱想战斗想改变全世界。</p>
<p> <img src="https://github.com/KangShanR/blogs/blob/master/pictures/baahuballi/11221463.png?raw=true" alt="3d scence"></p>
<p><img src="https://github.com/KangShanR/blogs/blob/master/pictures/baahuballi/11182994.png?raw=true" alt="3d scence_2"><br> 绝美3D大场景，</p>
<p><img src="https://github.com/KangShanR/blogs/blob/master/pictures/baahuballi/17288093.png?raw=true" alt="beautiful eyes"></p>
<p> <img src="https://github.com/KangShanR/blogs/blob/master/pictures/baahuballi/17245146.png?raw=true" alt="pretty girl"></p>
<p><img src="https://github.com/KangShanR/blogs/blob/master/pictures/baahuballi/17645928.png?raw=true" alt="beautiful eyes"><br> 各种虚光焦（妹子眼睛太好看了，忍不住再放一张），</p>
<p> <img src="https://github.com/KangShanR/blogs/blob/master/pictures/baahuballi/17502766.png?raw=true" alt="beautiful eyes"></p>
<p><img src="https://github.com/KangShanR/blogs/blob/master/pictures/baahuballi/17655319.png?raw=true" alt="beautiful eyes"><br> 各种慢镜头，</p>
<p> <img src="https://github.com/KangShanR/blogs/blob/master/pictures/baahuballi/17705988.png?raw=true" alt="beautiful eyes"></p>
<p><img src="https://github.com/KangShanR/blogs/blob/master/pictures/baahuballi/a81563ee-ec3a-417e-8089-e1bb5b0a3fcd.png?raw=true" alt="beautiful eyes"><br> 各种高颜值，</p>
<p> <img src="https://github.com/KangShanR/blogs/blob/master/pictures/baahuballi/14823355.png?raw=true" alt="beautiful eyes"><br> 各种强对比，</p>
<p> <img src="https://github.com/KangShanR/blogs/blob/master/pictures/baahuballi/18441408.png?raw=true" alt="beautiful eyes"><br> 各种细节特写，</p>
<p> <img src="https://github.com/KangShanR/blogs/blob/master/pictures/baahuballi/18425543.png?raw=true" alt="beautiful eyes"></p>
<p> <img src="https://github.com/KangShanR/blogs/blob/master/pictures/baahuballi/18542294.png?raw=true" alt="beautiful eyes"><br> 各种秀肌肉，</p>
<p> <img src="https://github.com/KangShanR/blogs/blob/master/pictures/baahuballi/18601933.png?raw=true" alt="beautiful eyes"><br> 各种经典画面构图。</p>
<p>单看剧情人物性格构造说它脑残也不过分，为了个人英雄而强行让剧情与配角全都为这个英雄服务，观众能猜到下十分钟的剧情。</p>
<p>比起刚在国内下场不久的《摔跤吧，爸爸！》，可以预料，不管在商业上还是口碑上可能都差一截，但这片子把印度电影的长处发挥得淋漓尽致。该耍帅耍帅，该跳舞跳舞一点也不含糊，背景音乐超带感，整部电影简直串起了若干个MV，用视听效果来带着整部电影飞。总的来说，不错的片子。</p>
<p><em>另外提一句，特效渲染是国内的一家叫“蓝海创意”团队做的，国内的特效技术其实一直都是杠杠的。该片其实早在今天4月份就在印度与北美上映，也就是说上映时间早于《摔跤吧，爸爸》。国内的话，就算上映也不会有多少票房了，优酷上都可以看了，大众还会有几个愿意买单呢。</em></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kangshanr.github.io/2017/08/25/神片试撸《巴霍巴利王II》/" data-id="cj70fi0if001ho8qnqk7uvkvd" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/movie/">movie</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-薛兆丰：经济学思维与个人投资" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/24/薛兆丰：经济学思维与个人投资/" class="article-date">
  <time datetime="2017-08-24T00:04:38.000Z" itemprop="datePublished">2017-08-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/经济学/">经济学</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/24/薛兆丰：经济学思维与个人投资/">得到直播：薛兆丰用经济学思维提升个人投资水平</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>得到直播：薛兆丰用经济学思维提升个人投资水平<br>这里有直播的概要记录，也在最后有一些自己的思考。</p>
<h3 id="中国经济会怎样？"><a href="#中国经济会怎样？" class="headerlink" title="中国经济会怎样？"></a>中国经济会怎样？</h3><blockquote>
<p><strong>一个国家的经济会不会好？5个标准：</strong></p>
</blockquote>
<ul>
<li>是否有一套完整的价值体系，过去30年中国改革开放的变化，一句话表述：由一个认人的社会变成了一个认钱的社会；一个认人的社会，社会资源的浪费会很大，一个认钱的社会会让社会的损耗降到最低。价格机制基本完善。</li>
<li>当中的制度让当中的人：一人做事一人当，别人做事别人当；每个人双手都放在自己的口袋里过日子。欧洲目前的难民危机：有一条难以接受，难民在欧洲领到救济，但不能工作。过去中国街头上有一群无所事事的年轻人，要成英雄用弹吉他、打架来定，但外资来了，工厂开过来了，这些一夜之间消失了。现在中国，每一个人，努力多一点，收获就多一点。年轻人上升的空间从来没有这么大，现在工作几年就可以独当一面，过去你想分到一套房要等到退休。</li>
<li>产权保护基于经济属性不基于物理属性。中国对共享经济、新兴产业的保护程度、接受程度比起欧洲好很多。日本做不通，劳动力贵。</li>
<li>政府是否有给新兴势力发展留有空间，新旧利益的交替是否顺利。Uber一兴起，社会的犯罪率就下降。人们对生活有了更多的期待。一碗水端平。</li>
<li>创新创业是不是受到保护。光看这些年国内举世无双的互联网、移动互联网产业，他们的兴起离不开整个社会体制的宽容与开放；</li>
</ul>
<h3 id="人机矛盾"><a href="#人机矛盾" class="headerlink" title="人机矛盾"></a>人机矛盾</h3><blockquote>
<p>人工智能来了，机器人带着大数据一路高歌猛进。人该怎么办？</p>
</blockquote>
<ul>
<li>知识是集中不起来的，知识很重要，但生产一支铅笔的所有知识，没有人能完全弄懂的。这里面的知识是完全分散到各个人脑子里的，机器不能解决这个问题，人工智能不能把这样一个带着权重的任务处理好的。登山这个需求不是实际问题的解决方案，是人想要与人不同的人辛苦地做一件没有实际价值的事，人工智能只能派直升机把你送上去。</li>
<li>未来不可预测，为什么？社会的发展会受到知识的影响，人们的知识变化、想法变化，知识总在增长，知识的增量对人的影响也不可预测，哪怕人工智能已经来了，它也不可能预测的；</li>
<li>人的想像力是机器不能替代的。从数据到逻辑理论当中始终有一个迁跃，这里面不是一条连续的逻辑推演。计算机可以作出曲子来，但它永远不知道这首曲子好不好听。</li>
<li>比较优势原理，机器很多的地方，人很贵的。</li>
<li>人怎么办？人去学机器做不到的事。学耐用的知识：数学，学习学习的方法，保持对知识的好奇心；有了好奇心，这个世界到处都是平台给你学习，人跟机器互动。人工智能不能替代人，人工智能只会让人更有价值，蒸汽机只会让更多的工作机会产生；</li>
</ul>
<h3 id="投资身外物"><a href="#投资身外物" class="headerlink" title="投资身外物"></a>投资身外物</h3><blockquote>
<p>当你有一笔可投资的钱，投在哪个地方？房产、比特币、股票、出国……</p>
</blockquote>
<ul>
<li>买房目的：是用来自用还是投资。长久租金应该与产权费差不多，租售同权一出，买房的意义又少一些。你的需要是什么？中国的买房费用与租金相差3倍之多。人往哪儿挤？不是嘴上说的开门见南山的山清水秀之地，而是人聚积的大城市；聚积的好处：高楼成本很高，积聚一来，规模来了，细化分工，人的价值开始提升，周围地价就上升了。</li>
<li>博弈论：你想去的地方，别人也一样想去，你想得到的东西，别人也一样想得到，你能想到的好点子，别人一样也想得到；世界区分：物理的世界按过程一步一步来，每一步都按照固定规律来；经济的世界，人对世界的预期来决定世物的价格，人们事物的预测来决定价值，一切皆不可预测，一旦人们预测到了，这个东西就不再被纳入价格预测之中，价格不可预测，股市也不可预测；有没有内幕消息？会不会比别人早知道消息？没有，那么只买长线吧，看好一个国家一个公司肯定在未来上升的；</li>
<li>比特币，要成为货币还有很长一段距离。它有一个兴旺发展的过程，但这也是一个庞氏骗局的温床。击鼓传花的游戏中，谁来接这最后一棒？</li>
</ul>
<h3 id="投资个人"><a href="#投资个人" class="headerlink" title="投资个人"></a>投资个人</h3><blockquote>
<p>对于自己的投资，更能掌控最可靠的投资方式</p>
</blockquote>
<ul>
<li>美国种族简历，所有人的收入统计起来，犹太人最富。地产会被外族收走，就投资首饰，首饰也被没收，就不得不选择知识、智力。</li>
<li>对知识的投资才是财富增长的根本原因。温度、资源都不是原因，人力资本才是改变个人改变世界的引擎；</li>
<li>学习各种各样的成功学，要记住别人的成功永远不可能复制过来的，永远不要忘记做自己手头能够做的事情。收入不均的问题， 不同的行业不同的人力有不同收入。用远大的目标来校正今天当下的行为。我们要追求的不是一刹那的幸福，不是当下的收入，而是一生幸福的总和，一辈子总收入。我们要看中二三十年后幸福收入总和。李嘉诚现在是赚很多钱，不是说当年他受过多少苦，他最让人佩服的是当年他在黑暗的隧道里眼前一样难以看到希望的时候，依然选择了努力，选择了学习。</li>
</ul>
<h4 id="后记："><a href="#后记：" class="headerlink" title="后记："></a><em>后记：</em></h4><p>8/24/2017 10:02:53 PM </p>
<hr>
<ul>
<li>得到直播都是晚8点开始，这次薛老师一直讲到9点半，中途休息过两次都是讲得太久不得不喝口水休息一下，广告只在结束后小娴来拉的。</li>
<li>讲得很生动，听得我一直没有停下来过。听了之后开始反思这一段时间对自己的放松，这么长一段时间来自己对自己要求的降低，追求内心满足于小事，并不是让自信来源于自律，只来自于想像。</li>
<li>这个经济学课一开始就订阅了，刚开始的时候还听得挺认真，也有留言过，也有入选过一次精选，但后面开始学代码时，就没有抽时间来专门学习了，每天也只是在路上带着耳机听下，没有进行过深入思考。但具体反思一下，就算在开始认真听这个产品时，我也常常觉得这个还没学等待会有时间了就认真听一下，像故事中的狐狸一样，安慰自己只有在神奇岛上才能跳出最神奇的舞蹈，但别人都知道，我每天都踩在神奇岛的土地上。反观这个故事，其实狐狸也在骗自己，在某种天时地利下，自己可以跳出感动世界的舞，但这个行动一直没有实践过，也就导致了狐狸永远地看不到自己舞姿的拙劣，在各种小事中来获取满足感。这种心理机制的逻辑：<ul>
<li>没自信面对自己失败的尴尬，导致一直把可能导致这种尴尬的情况给排开，并骗自己后面时机一到就亮绝活；</li>
<li>再在生活中找所谓的”小确幸“，并满足于这些众多的自嗨的”小确幸“；</li>
<li>直到无可挽回的地步时，就找到另外一个可以让自己隐藏自己可怜的实力点，再进入到第一步开始下一轮循环；</li>
</ul>
</li>
<li>在这个死循环中，哪里一环可以被打破？每一环。每一环都应该提醒自己自信地面对自己，把手头的事做好就是打破魔咒的法宝。</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kangshanr.github.io/2017/08/24/薛兆丰：经济学思维与个人投资/" data-id="cj70fi0ic001co8qnkudj9yj9" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/igot/">igot</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/经济学/">经济学</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-卓老板：科学思维看世间百态" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/23/卓老板：科学思维看世间百态/" class="article-date">
  <time datetime="2017-08-23T00:02:42.000Z" itemprop="datePublished">2017-08-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/心得笔记/">心得笔记</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/23/卓老板：科学思维看世间百态/">科学思维看世间百态</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>今天得到直播卓老板聊科技：用科学思维看世界运行的脉络，怎么看？直播的一些记要与心得：</p>
<ul>
<li>科学思维三板斧：<ul>
<li>等比缩放：WHO建议少吃糖，男性一天不超过28.5g，怎么算你的食物中有多少的糖？等比缩放。<ul>
<li>把原来没有关系的两个事物放在自己能触及的地方；</li>
<li>比如：纳米和亿之间的关联怎么与你相关？<ul>
<li>我的身高是米，cpu的粒子是14纳米，我跟cpu就是亿倍关系。</li>
<li>滴答声一下是1秒，10亿意味着什么？就是32年。对于我们来说32年意味着什么大家肯定就有自己的概念了。</li>
</ul>
</li>
</ul>
</li>
<li>近似计算：通过简单地计算把一个问题定位到一个大概的范围，计算出一个大概的结果；<ul>
<li>思维游戏问题：举国之电力，都由太阳能实现行不行？<ul>
<li>假如国家的财力无穷无尽，帝国时代游戏一般来设计我们太阳能？在沙漠中来铺开太阳能板</li>
<li>在高速公路两边的绿带铺开？下雨、阴天、维修，全国13万公里的高速公路，</li>
</ul>
</li>
<li>近似计算鼻祖：费米，第一颗原子弹在内华达州的试爆，用纸片受远距离冲击波影响的飘距来近似计算爆炸当量（算得1万吨TNT当量，事后科学计算得2万吨），误差只有一倍（在质能方程中，估算当量误差往往很大）</li>
<li>对于陌生世界与陌生事物临到面前时，近似计算能力对于掌握新事物的到来很有帮助；平常生活中，这一项能力十分有用；</li>
<li>财务或其他对接事务时：不能有太多约束；比如，坟墓的占地在多久后会把人类居住地占完？但两代人后，人们不会对祖先的领地维护的。</li>
</ul>
</li>
<li>建立模型：如果把人类的知识分类，<ul>
<li>自下而上的知识，比如，考古，它的建立是一点一点地累积下来的，只能一块一块地拼图，最开始在边缘上找，再一点点往前推，在这个过程中，我们只能一点点积累证据，一点点接近真理；</li>
<li>自上而下的知识：流行病学，怎么传播，设定一些参数。建立一个模型，再用这个模型来推算其发展形态；如果生活中有问题能用一个模型来解释，那么就用这个模型来计算；</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="后记："><a href="#后记：" class="headerlink" title="后记："></a>后记：</h4><ul>
<li>科学思维不能让你计算出未来事情准确发展动向，但能让你对事态的发展有一个大概地了解，不会一脸懞逼，而失去行事重心。</li>
<li>开始一场话之前，要对这场进行预判，在这场谈话中要达到什么目的；<ul>
<li>如果这场话的目的在于让对方有一个很好的感受，那么在谈话过程中就尽量赞许对方，让对方流畅地表达出内心地骄傲；</li>
<li>如果要把自己突显出来，一定要话少，但一定要言必有物，每次场话有两三次谈话让别人印象深刻就很成功了。如果你的科学思维让你比别人看事物问题的角度更新颖开放，那么，一场谈话下来，很容易抓住这两个点让别人刮目相看。</li>
</ul>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kangshanr.github.io/2017/08/23/卓老板：科学思维看世间百态/" data-id="cj70fi0i00011o8qnxoxkuueq" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/igot/">igot</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/科技/">科技</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-得到直播：打造工作方法" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/23/得到直播：打造工作方法/" class="article-date">
  <time datetime="2017-08-23T00:02:42.000Z" itemprop="datePublished">2017-08-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/每日精进/">每日精进</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/23/得到直播：打造工作方法/">得到直播：打造工作方法</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>今天得到直播:打造工作方法有些启发，直播的一些记要与心得：</p>
<h4 id="罗胖-打造工作方法"><a href="#罗胖-打造工作方法" class="headerlink" title="罗胖:打造工作方法"></a>罗胖:打造工作方法</h4><ul>
<li>复制，任何行业，拿走的最多的红利的人不是最顶尖高手的人，而是专业力不错，但同时会复制传播的人，最直接简单的方式：写作，演讲；</li>
<li>怎么把成本覆盖掉，怎么把利复制？王石，任何一个麻烦找上我，我想法就是怎么让这个麻烦下次不再找上我；</li>
<li>正收益能不能复制？怎么提高自己的可复制性？<ul>
<li>三个字：确定性。</li>
<li>工作方法的高下就一点，能不能给确定性？<ul>
<li>能力的确定性；<ul>
<li>靠谱与闭环，大家要知道你能力的边界，能力再小，网络中价值中都极大；老干妈，这个产品水平极高吗？不，但海外留学生都知道，想吃到中国味，老干妈一定没错；凡事有交待，件件有回应，不能成为反馈黑洞；</li>
</ul>
</li>
<li>态度的确定性<ul>
<li>态度不好拿，想得太多；</li>
<li>找到最基本简单的态度，坚持下去；</li>
</ul>
</li>
<li>范围的确定性<ul>
<li>每个人不管在什么层级，都是在创业；</li>
<li>时时刻刻要在所有人面前要表现，你在掌握全局；</li>
<li>思维：<ul>
<li>上推，上推具体的操作到正式制度性抽象概念，高级餐厅的牛排旁边一定要放几朵西兰花，这样才显得高级；</li>
<li>下沉，你不是不写嘛，我来，你要觉得这个可以接受，那么我自己做点事，像水一样，把其他的地方勾勒出来，当对方接收到这个动作时，对方被水包裹后自然而然会被牵动；</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<h4 id="最后有一段充满力量的话："><a href="#最后有一段充满力量的话：" class="headerlink" title="最后有一段充满力量的话："></a>最后有一段充满力量的话：</h4><p>王朔给女儿:（核心：把握自己，确定性；）</p>
<blockquote>
<p>煲汤比写诗重要；<br>自己的手艺比男人的重要；<br>头发、胸、腰、屁股比脸重要；<br>内心强大到混蛋比什么都重要；</p>
</blockquote>
<p>在网上查了下，冯唐写这段话应该更早的，王朔应该是借用的冯唐的。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kangshanr.github.io/2017/08/23/得到直播：打造工作方法/" data-id="cj70fi0i30013o8qn981v85w7" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/igot/">igot</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-spring" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/15/spring/" class="article-date">
  <time datetime="2017-08-15T04:14:38.000Z" itemprop="datePublished">2017-08-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/java/">java</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/15/spring/">spring框架的学习</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>spring配置beans的底层原理就在于通过封装好的解析xml类，将xml文件中配置好的bean实例出一个对象来，再通过配置实现bean之间的相互引用，而实现将要用到的bean（实用类）实例化并使用；</p>
</blockquote>
<h2 id="Core模块"><a href="#Core模块" class="headerlink" title="Core模块"></a>Core模块</h2><ul>
<li>bean标签：<ul>
<li>id属性指定这个实例的唯一标识；</li>
<li>class属性，用来指定这个实例的类定义；</li>
<li>property子元素，指定这个对象的属性，比如：user对象中有属性name,那么这个这个user的bean对象就应该有一个子元素标签property，同时如果这个属性是另外一个本地的bean，name属性指向这个属性：<code>&lt;property name=&quot;advice&quot; id=&quot;beanId&quot;&gt;</code>直接使用id属性来引用到其他的bean的id就行；</li>
</ul>
</li>
</ul>
<h2 id="AOP模块"><a href="#AOP模块" class="headerlink" title="AOP模块"></a>AOP模块</h2><blockquote>
<p>Aspect Oriented Programming,面向切面编程</p>
</blockquote>
<ul>
<li>切面Aspect:可以理解为模块，比如，读写数据库、权限检查、异常情况记录；</li>
<li>Advice,增强：拦截器实现增强接口Advisor，不同的拦截器实现不同的增强接口，比如：方法前拦截器<pre><code>MethodBeforeInterceptor implements MethodBeforeAdvice{
    //方法前拦截器
    //调用对象的方法前将执行该方法。参数分别为被调用的方法、参数、对象
    public void before(Method method, Object[] args, Object instance) throws Throwable{
        System.out.println(&quot;即将要执行的方法：“+method.getName());
        //如果是Service
        if(instance instanceof WaiterServiceImpl)
            String name = ((AopServiceImpl) instance).geName();
                if(name == null)//检查是否为空
                    throw new NullPointerException(&quot;name属性不能为null&quot;);
        }
        method.invoke(instance,args);
    }
}
</code></pre></li>
<li>拦截器，interceptor，也是pointcut的核心:<ul>
<li>spring拦截器的配置实现，通过增加配置：<pre><code>&lt;bean id=&quot;aopMethodBeforeInterceptor&quot; class=&quot;org.springframework.aop.supoort.NameMatchMethodPointcutAdvisor&quot;&gt;
    &lt;property name=&quot;advice&quot;&gt;
        &lt;bean class=&quot;com.snail.aopdemo.advice.MethodBeforeInterceptor&quot;/&gt;
    &lt;/property&gt;
    &lt;property name=&quot;mappedName&quot; value=&quot;withAop&quot;&gt;&lt;/property&gt;
&lt;/bean&gt;
</code></pre></li>
<li>从上面的代码可以看出：<ul>
<li>spring实现拦截器都是通过增强器Advisor，而这个增强器是一个代理，将参数（自定义的Advice）作为参数传入其中；</li>
<li>同时mappedName属性用来指定拦截的方法，这个方法并不是增加类中的方法，而是到时要执行到的所有的匹配方法名字段的方法；</li>
<li>同时：spring支持由正则表达式配置切入点：<pre><code>&lt;property name=&quot;patterns&quot;&gt;      &lt;!-- 正则表达式配置切入点--&gt;
    &lt;list&gt;
        &lt;value&gt;.*get.*&lt;/value&gt; &lt;!--包含get字段的方法就被拦截&gt;
        &lt;value&gt;.*absquatulate&lt;/value&gt;  &lt;!--包含absquatutulat字段的方法被拦截&gt;
    &lt;/list&gt;
&lt;/property&gt;
</code></pre></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="ORM模块"><a href="#ORM模块" class="headerlink" title="ORM模块"></a>ORM模块</h2><blockquote>
<p>Object RelativeDatabase Mapping,对象关系型数据库映射</p>
<ul>
<li>简介：<ul>
<li>此模块对Hibernate/JDO/TopLink、iBatis等ORM框架提供支持；</li>
<li>Spring提供在DAO层提供HibernateDaoSupport类与JDBCTemplate类；</li>
<li>在Spring里，Hibernate与SessionFactory等只是Spring一个特殊的Bean，由Spring负责实例化与销毁；所以也就不需要与Hibernate的API打交道，不需要开启关闭Hibernate的Session、Transaction，Spring自动维护这些对象；</li>
</ul>
</li>
</ul>
</blockquote>
<h4 id="实体类"><a href="#实体类" class="headerlink" title="实体类"></a>实体类</h4><p>这儿用User类举例：</p>
<ul>
<li>使用注解来让User中属性与数据库中表的列相关联；</li>
<li>Entity类的注解：<ul>
<li>@Entity，表明这个类为实体类；</li>
<li>@Table（name=”users”),指明此实体类与数据库users表相关联；</li>
<li>属性的注解：<ul>
<li>@Id，主键注解，表明这属性为数据库表中的主键</li>
<li>@GeneratedValue（strategy=GenerationType.IDENTITY),指明该主键生成策略为自增</li>
<li>@Temporal（value = TemporalType.Date),表明列属性为Date</li>
</ul>
</li>
</ul>
</li>
<li>DAO层接口，不同的Entity对应不同的DAO接口：<ul>
<li>UserDao接口，就定义对User表的操作：<pre><code>public interface UserDao{
    public void saveUser(User user);
    public List&lt;User&gt; findUsers();
    public int getCount ();
    public User findUserByName(String name);
}
</code></pre></li>
<li>UserDao接口的实现类，UserDaoImpl：<ul>
<li>这个实现类要继承HibernateDaoSupport类，这就意味着从父类继承了Hibernate与HibernateTimplate对象，该对象就对实体对象进行各类操作；<pre><code>public class UserDaoImpl extends HibernateDaoSupport implements UserDao{
    //实现接口中的方法
    public void saveUser(User user){
        this.getHibernateTemplate().persist(user);//使用父类方法get到Template,并调用其persist方法将user存入
    }
}
    public int getCount(){    //查询记录条数
        Number num = (Number)this.getSession(true).createQuery(&quot;select count (*) from User).uniqueResult();
        return n.intValue();
    }
    public List&lt;User&gt; findUsers(){  //查询所有的user
        return this.getHibernateTemplate().find(&quot;select * from User&quot;);
    }
    public User findUserByName(String name){  //根据用户名查询用户
        List&lt;User&gt; users = this.getHibernateTemplate().find{&quot;select * from User u where u.name=?&quot;, name);  //使用Template
        if(users.size() &gt; 0)
            return users.get(0);返回第一条
        return null;
    }
}
</code></pre></li>
</ul>
</li>
<li><strong><em>从上述代码例子中可以看出：</em></strong><ul>
<li>查询(Read)、创建(Create)都由父类HibernateDaoSupport提供的getHibernateTemplate方法获取到实例并执行实例的方法来实现，其中查询使用实例方法find(String sql, Stirng 拼接String），而save则用持久化方法persist(Object user);</li>
<li>当要涉及到数据库计算时，则用getSession获取到与数据库的会话对象，让会话对象执行sql统计语句；</li>
<li>同时，所有sql语言的操作对象都指向实体类，而没有对数据库中的表进行组织sql语句；</li>
</ul>
</li>
<li><strong>个人理解：</strong>spring通过封装Hibernate在框架中，让DAO接口的实现类继承HibernateDaoSupport尖，就将Hibernate对象创建出来，而直接操作这个对象的方法来获取session/Hibernate对象直接与数据库交互，而就节省了操作JDBC的代码；</li>
</ul>
</li>
</ul>
<h4 id="配置集成Hibernate"><a href="#配置集成Hibernate" class="headerlink" title="配置集成Hibernate"></a>配置集成Hibernate</h4><ul>
<li>在spring的bean.xml文件中配置集成hibernate到目前这一步只需要<strong><em>配置三个bean</em></strong>：<ul>
<li>数据源datasource，这是一切的基础，所有的操作最终都会落到对数据库的操作上；<pre><code>&lt;bean id=&quot;datasource&quot; class=&quot;org.apache.commonsdbcp.BasicDataSource&quot;&gt;
    &lt;property name=&quot;driverClassName&quot; class=&quot;org.gjt.mm.mysql.Driver&quot;&gt;&lt;/property&gt;
    &lt;property name=&quot;url&quot; value=&quot;jdbc\:mysql\://localhost\:3306/ssh&quot;&gt;&lt;/property&gt;
    &lt;property name=&quot;username&quot; value=&quot;root&quot;&gt;&lt;/property&gt;
    &lt;propery name=&quot;password&quot; value=&quot;&quot;&gt;&lt;/property&gt;
&lt;/bean&gt;
</code></pre>  <em>- 数据源的配置就是用依赖包中的一个封装好的类（这儿就是BasicDataSource）的对象，并将这个对象的属性值配置好，这些属性就包括了数据库的驱动、连接的url、连接数据库的用户名、密码。可以想象的是，这个处理数据库的对象封装了所有的连接数据库的方法，使用密码与用户名，交给驱动对象，这个驱动对象就按照提供的url连接到主机上的数据库，并登录到数据库；</em></li>
<li>有了数据源，就可以将关联连接库的数据源配置到sessionFactory中去：<pre><code>&lt;bean id=&quot;sessionFactory&quot; class=&quot;org.springframework.orm.hibernate4.annotation.AnnotationSessionFactoryBean&quot; destroy-method=&quot;destroy&quot;&gt;
    &lt;property name=&quot;dataSource&quot;&gt;
        &lt;ref bean=&quot;dataSource&quot;/&gt;
    &lt;property/&gt;
    &lt;property name=&quot;annotatedClasses&quot;&gt;
        &lt;list&gt;
            &lt;value&gt;com.woniuxy.orm.class_qulified_name&lt;/value&gt;
        &lt;/list&gt;
    &lt;property/&gt;
    &lt;property name=&quot;hibernateProperties&quot;&gt;
        &lt;pros&gt;
            &lt;pro key=&quot;hibernate.dialect&quot;&gt;
                org.hibernate.dialect.MySQLDialect
            &lt;/pro&gt;
            &lt;pro key=&quot;hibernate.show_sql&quot;&gt;true&lt;/pro&gt;
            &lt;pro key=&quot;hibernate.format_sql&quot;&gt;true&lt;/pro&gt;
            &lt;pro key=&quot;hibernate.hbm2ddl.auto&quot;&gt;create&lt;/pro&gt;
        &lt;/pros&gt;
    &lt;/property&gt;
&lt;/bean&gt;
</code></pre><ul>
<li><em>配置会话工厂（因为我们的实体类使用的注解映射，所以就使用注解会话工厂AnnotationSessionFatoryBean)其中包括了：数据源、实体类还有hibernate,而hibernate的配置就包括了方言、输出sql语句、格式化sql语句、创建表结构</em></li>
</ul>
</li>
<li>有了会话工厂，距离操作数据库就只有让Dao配置为bean，而操作代码就getBean来获取到这个Dao的实例，让这个实例来操作数据库：<pre><code>&lt;bean id=&quot;userDao&quot; class=&quot;daoImpl_qualified_name&quot;&gt;
    &lt;property name=&quot;sessionfactory&quot; ref=&quot;sessionFactory&quot; /&gt;
&lt;/bean&gt;
</code></pre><ul>
<li><em>在Dao的bean中，将前面配置好的sessionFactory装配到其中</em></li>
</ul>
</li>
<li>以上情况是实体类User是使用注解来配置的，这种情况下，使用的sessionFactory是AnnotationSessionFactoryBean,但当实体类是使用xml文件来配置时，使用的配置bean应该是LocalSessionFactoryBean。同时，sessionFactory中配置实体的方式也变成：<pre><code>&lt;property name=&quot;mappingDirectoryLocations&quot;&gt;
    &lt;list&gt;
        &lt;value&gt;classpath:entiteis_配置文件的路径&lt;/value&gt;
    &lt;/list&gt;
&lt;/property&gt;
</code></pre></li>
</ul>
</li>
</ul>
<h3 id="Hibernate的事务管理"><a href="#Hibernate的事务管理" class="headerlink" title="Hibernate的事务管理"></a>Hibernate的事务管理</h3><ul>
<li><strong>分层的做法：应用层调用Service层，Service层对数据进行检查（是否重复之类），然后Service层（注入一个Dao属性）调用Dao层，Dao层调用Hibernate实现数据的操作。原则上不允许跨层访问，业务层次分明。</strong></li>
<li>事务管理transaction，对应的层为Service层；</li>
</ul>
<h3 id="spring的bean-xml配置文件的理解"><a href="#spring的bean-xml配置文件的理解" class="headerlink" title="spring的bean.xml配置文件的理解"></a>spring的bean.xml配置文件的理解</h3><ul>
<li>所有的操作都基于对数据库的crud，所以所有的配置都围绕着操作数据库；</li>
<li>所以，第一个bean的是数据源：dataSource<ul>
<li>其中的属性就包括：<ul>
<li>连接数据库的驱动：driverClassName</li>
<li>数据库连接url:url</li>
<li>数据库连接用户名：username</li>
<li>数据库连接密码：password</li>
</ul>
</li>
<li>通常情况下，我们把数据源信息都单独分离在jdbc.properties文件中，并在要用到的配置文件中将其配置为上下文<code>&lt;context:property-placeholder&gt; location=&quot;classpath:jdbc.properties/&gt;</code>，之后就可以在数据源dataSource中配置其中的属性：<code>&lt;property name=&quot;driverClass&quot; value=&quot;${driver}&quot;&gt;&lt;/property&gt;</code></li>
</ul>
</li>
<li>第二个配置的bean：sessionFactory<ul>
<li>这儿就把上一次配置好的dataSource数据源装配到sessionFactory的属性中：<pre><code>&lt;!-- 配置本地会话工厂bean --&gt;
&lt;bean id=&quot;sessionFactory&quot; class=&quot;org.springframework.orm.hibernate5.LocalSessionFactoryBean&quot;&gt;
    &lt;!-- 配置数据源 --&gt;
    &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt;
    &lt;!-- 指定hibernate配置文件--&gt;
    &lt;property name=&quot;configLocations&quot; value=&quot;classpath:hibernate.cfg.xml&quot;/&gt;
    &lt;!-- 指定hibernate映射文件--&gt;
    &lt;property name=&quot;mappingDirectoryLocations&quot;&gt;
        &lt;list&gt;
            &lt;value&gt;classpath:mappings/*.xml&lt;/value&gt;
        &lt;/list&gt;
    &lt;/property&gt;
&lt;/bean&gt;
</code></pre><ul>
<li>Note:<em>这儿配置spring的sessionFactory属性就会把Hibernatek r sessionFactory属性覆盖；</em></li>
<li>configLocations属性：<em>将指定路径的配置文件都加载进去，相应的LocalSessionFactoryBean中的的此属性的setter方法的参数为可变参数:</em><pre><code>public void setConfigLocations(Resource... configLocations) {
    this.configLocations = configLocations;
}
</code></pre></li>
</ul>
</li>
<li>而在上述代码中，hibernate的配置文件也直接引入到sessionFatory中来，而在外部的hibernate配置文件：<br>  <hibernate-configuration><pre><code>&lt;session-factory&gt;
    &lt;!-- 配置方言 --&gt;
    &lt;property name=&quot;hibernate.dialect&quot;&gt;org.hibernate.dialect.MySQL5InnoDBDialect&lt;/property&gt;
    &lt;!-- session上下文控制权:交给session来控制 --&gt;
    &lt;property name=&quot;hibernate.current_session_context_class&quot;&gt;org.springframework.orm.hibernate5.SpringSessionContext&lt;/property&gt;
    &lt;!-- 格式化sql语句 --&gt;
    &lt;property name=&quot;format_sql&quot;&gt;true&lt;/property&gt;
    &lt;!-- 显示sql语句 --&gt;
    &lt;property name=&quot;show_sql&quot;&gt;true&lt;/property&gt;
    &lt;!-- 表的生成策略 --&gt;
    &lt;property name=&quot;hbm2ddl.auto&quot;&gt;update&lt;/property&gt;
&lt;/session-factory&gt;
</code></pre>  </hibernate-configuration><ul>
<li>其中配置了部分的Hibernate属性，同时也可以配置c3p0的属性在其中；</li>
</ul>
</li>
</ul>
</li>
<li>第三个配置：事务管理器transactionManager<ul>
<li>将前面配置好的sessionFactory装配到这个bean中，作为sessionFactory属性值；</li>
</ul>
</li>
<li><p>第四个配置：tx:advice，配置事务的传播特性，指定具备事务的方法名；</p>
<pre><code>&lt;!-- 事务配置增强 --&gt;
&lt;tx:advice id=&quot;txAdvice&quot; transaction-manager=&quot;txMng&quot;&gt;
     &lt;tx:attributes&gt;
         &lt;tx:method name=&quot;save*&quot; isolation=&quot;DEFAULT&quot; propagation=&quot;REQUIRED&quot;/&gt;
         &lt;tx:method name=&quot;update*&quot; isolation=&quot;DEFAULT&quot; propagation=&quot;REQUIRED&quot;/&gt;
         &lt;tx:method name=&quot;delete*&quot; isolation=&quot;DEFAULT&quot; propagation=&quot;REQUIRED&quot;/&gt;
         &lt;tx:method name=&quot;batch*&quot; isolation=&quot;DEFAULT&quot; propagation=&quot;REQUIRED&quot;/&gt;

         &lt;tx:method name=&quot;get*&quot; isolation=&quot;DEFAULT&quot; propagation=&quot;REQUIRED&quot; read-only=&quot;true&quot;/&gt;
         &lt;tx:method name=&quot;load*&quot; isolation=&quot;DEFAULT&quot; propagation=&quot;REQUIRED&quot; read-only=&quot;true&quot;/&gt;
         &lt;tx:method name=&quot;find*&quot; isolation=&quot;DEFAULT&quot; propagation=&quot;REQUIRED&quot; read-only=&quot;true&quot;/&gt;

         &lt;!-- 统配 --&gt;
         &lt;tx:method name=&quot;*&quot; isolation=&quot;DEFAULT&quot; propagation=&quot;REQUIRED&quot; read-only=&quot;true&quot;/&gt;
     &lt;/tx:attributes&gt;
 &lt;/tx:advice&gt;
</code></pre><ul>
<li>最后一行统配就指定了所有的方法都配置上事务，同时isolation指此事务的隔离级别，propagation指事务的传播属性，read-only指是否为只读；</li>
</ul>
</li>
<li>第五个配置aop:config，配置事务的切入点，以及被管理的对象<pre><code>&lt;aop:config&gt;
    &lt;aop:pointcut id=&quot;interceptorPointCuts&quot; expression=&quot;execution(* com.woniuxy.sshdemo.service.impl.*(..))&quot;/&gt;
    &lt;aop:advisor advice-ref=&quot;txAdvice&quot; pointcut-ref=&quot;interceptorPointCuts&quot;/&gt;
&lt;/aop:config&gt;
</code></pre><ul>
<li>先将切面的切点配置进来，也就是各个service的执行对象。再将这此切点配置到advisor中</li>
</ul>
</li>
<li>其它的配置：<ul>
<li>dao的执行类，配置一个id加上sessionFactory;</li>
<li>service的执行类,配置上dao这个属性的对象；</li>
</ul>
</li>
<li><strong>使用注解来实现事务的配置</strong><ul>
<li>这时bean.xml：<ul>
<li>数据源不变</li>
<li>sessionFactory不变；</li>
<li>事务管理器trasactionManager依然不变；</li>
<li>变的是：添加一个事务注解驱动<code>tx:annotation-driven trasaction-manager=&quot;transactionManager&quot;/&gt;</code>，添加这个驱动配置后，对产生事务的类添加注解<code>@Transactional</code>，标记这个类为事务类，对其中的事务方法添加注解<code>@Transactional(isolation=Isolation.DEFAULT,propagation=Propagation.REQUIRED)</code>注解（标明了这个方法的隔离水平与传播水平）。这样的注解就取代了上面例子中tx:advice与aop:config两个配置节点的功能；</li>
</ul>
</li>
</ul>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kangshanr.github.io/2017/08/15/spring/" data-id="cj70fi0hp000oo8qnh1qy0r0o" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/framework/">framework</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-java_reference" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/13/java_reference/" class="article-date">
  <time datetime="2017-08-13T04:04:38.000Z" itemprop="datePublished">2017-08-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/java/">java</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/13/java_reference/">java底层之引用</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="直接引用与符号引用"><a href="#直接引用与符号引用" class="headerlink" title="直接引用与符号引用"></a>直接引用与符号引用</h4><p><strong>JVM运行类加载后， 在类的解析阶段，JVM会把类的二进制数据中的符号引用替换为直接引用。</strong></p>
<h4 id="符号引用：Symbolic-References"><a href="#符号引用：Symbolic-References" class="headerlink" title="符号引用：Symbolic References"></a>符号引用：Symbolic References</h4><ul>
<li>以一组符号来描述 所引用的目标，而这个符号可以是任何形式的字面量，只要使用时可以无歧义定位到目标即可;</li>
<li>存在的原因：在编译阶段，java类并不知道所引用类的实际地址，只能使用符号来表示类的地址。而且在不同JVM实现的内存地址也不尽相同，经过符号引用这一道工序，同一个类，其符号引用必然一致；</li>
<li>类在解析过程中，就根据JVM实时产生的内存分配状况，将符号引用转为直接引用；</li>
</ul>
<h4 id="直接引用：Direct-References"><a href="#直接引用：Direct-References" class="headerlink" title="直接引用：Direct References"></a>直接引用：Direct References</h4><p><strong>- 直接引用是和虚拟机的布局直接相关的，同一个符号引用在不同的JVM上翻译出来的直接引用也不尽相同。某个目标有了直接引用，那说明这个目标已经被加载到内存中了</strong></p>
<ul>
<li>直接引用可以是：<ul>
<li>直接指向目标的指针（如，指向类型class对象、类变量、类方法的直接引用就是指向方法区的指针）；</li>
<li>相对偏移量：如指向实例变量、实例方法的直接引用都是偏移量；</li>
<li>一个能直接定位到目标的句柄；</li>
</ul>
</li>
</ul>
<hr>
<p><strong>Note:</strong></p>
<ul>
<li><em>也就是说通过符号引用转换为直接引用来实现了引用的跨平台（对于同一个数据对象的引用都用同一个符号引用来实现，而在不同的平台上不同的JVM运行时转换成不同的直接引用）</em></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kangshanr.github.io/2017/08/13/java_reference/" data-id="cj70r8fwx000q6cqnxat1hw6d" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JVM/">JVM</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/">java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/跨平台/">跨平台</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/LeadingEnd/">LeadingEnd</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/">database</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/job/">job</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/">programming</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/个人网站搭建/">个人网站搭建</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端/">前端</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/心得笔记/">心得笔记</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/每日精进/">每日精进</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/经济学/">经济学</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/观影无感/">观影无感</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/随笔/">随笔</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/面向对象/">面向对象</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/项目开发/">项目开发</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/JVM/">JVM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mybatis/">Mybatis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/enum/">enum</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/essay/">essay</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/framework/">framework</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/">github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/html/">html</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/html5/">html5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/igot/">igot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java内部类/">java内部类</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/job/">job</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jsp/">jsp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/movie/">movie</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/programming/">programming</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tale/">tale</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tips/">tips</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/匿名内部类/">匿名内部类</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/单例模式/">单例模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/控制台/">控制台</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据库/">数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/科技/">科技</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/线程安全/">线程安全</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/经济学/">经济学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/观影无感/">观影无感</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计原则/">设计原则</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计模式/">设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/访问修辞符/">访问修辞符</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/跨平台/">跨平台</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/迭代器/">迭代器</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/JVM/" style="font-size: 10px;">JVM</a> <a href="/tags/Mybatis/" style="font-size: 10px;">Mybatis</a> <a href="/tags/enum/" style="font-size: 10px;">enum</a> <a href="/tags/essay/" style="font-size: 10px;">essay</a> <a href="/tags/framework/" style="font-size: 12.5px;">framework</a> <a href="/tags/github/" style="font-size: 10px;">github</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/html/" style="font-size: 10px;">html</a> <a href="/tags/html5/" style="font-size: 10px;">html5</a> <a href="/tags/igot/" style="font-size: 15px;">igot</a> <a href="/tags/java/" style="font-size: 20px;">java</a> <a href="/tags/java内部类/" style="font-size: 10px;">java内部类</a> <a href="/tags/job/" style="font-size: 10px;">job</a> <a href="/tags/jsp/" style="font-size: 10px;">jsp</a> <a href="/tags/movie/" style="font-size: 10px;">movie</a> <a href="/tags/mysql/" style="font-size: 10px;">mysql</a> <a href="/tags/programming/" style="font-size: 17.5px;">programming</a> <a href="/tags/tale/" style="font-size: 10px;">tale</a> <a href="/tags/tips/" style="font-size: 10px;">tips</a> <a href="/tags/匿名内部类/" style="font-size: 10px;">匿名内部类</a> <a href="/tags/单例模式/" style="font-size: 12.5px;">单例模式</a> <a href="/tags/控制台/" style="font-size: 10px;">控制台</a> <a href="/tags/数据库/" style="font-size: 10px;">数据库</a> <a href="/tags/科技/" style="font-size: 10px;">科技</a> <a href="/tags/算法/" style="font-size: 10px;">算法</a> <a href="/tags/线程安全/" style="font-size: 10px;">线程安全</a> <a href="/tags/经济学/" style="font-size: 10px;">经济学</a> <a href="/tags/观影无感/" style="font-size: 10px;">观影无感</a> <a href="/tags/设计原则/" style="font-size: 10px;">设计原则</a> <a href="/tags/设计模式/" style="font-size: 10px;">设计模式</a> <a href="/tags/访问修辞符/" style="font-size: 12.5px;">访问修辞符</a> <a href="/tags/跨平台/" style="font-size: 10px;">跨平台</a> <a href="/tags/迭代器/" style="font-size: 10px;">迭代器</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">April 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">March 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/08/31/mybatis/">Mybatis框架的应用与理解</a>
          </li>
        
          <li>
            <a href="/2017/08/29/singleton_pattern/">设计模式之单例模式</a>
          </li>
        
          <li>
            <a href="/2017/08/29/20170829IgotMeeting/">得到例会：关于找工作</a>
          </li>
        
          <li>
            <a href="/2017/08/26/今日无题/">无题</a>
          </li>
        
          <li>
            <a href="/2017/08/25/神片试撸《巴霍巴利王II》/">神片试撸《巴霍巴利王II》</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 KangShan<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>